<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>IoticAgent.IOT.Client API documentation</title>
    <meta name="description" content="The Client object used to initiate connection to Iotic Space" />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #05B;
    text-decoration: none;
    font-weight: 500;
    border-bottom: 1px dashed #CCCCCC;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #E95420;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  }

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; }

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;

      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Core_Version">Core_Version</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.DEBUG_ENABLED">DEBUG_ENABLED</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.E_FAILED_CODE_ACCESSDENIED">E_FAILED_CODE_ACCESSDENIED</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.E_FAILED_CODE_INTERNALERROR">E_FAILED_CODE_INTERNALERROR</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.E_FAILED_CODE_MALFORMED">E_FAILED_CODE_MALFORMED</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.E_FAILED_CODE_NOTALLOWED">E_FAILED_CODE_NOTALLOWED</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.E_FAILED_CODE_UNKNOWN">E_FAILED_CODE_UNKNOWN</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.M_CLIENTREF">M_CLIENTREF</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.M_PAYLOAD">M_PAYLOAD</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.P_CODE">P_CODE</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.P_DATA">P_DATA</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.P_ENTITY_LID">P_ENTITY_LID</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.P_EPID">P_EPID</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.P_ID">P_ID</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.P_LID">P_LID</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.P_MESSAGE">P_MESSAGE</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.P_POINT_ID">P_POINT_ID</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.P_POINT_TYPE">P_POINT_TYPE</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.P_RESOURCE">P_RESOURCE</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.R_CONTROL">R_CONTROL</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.R_ENTITY">R_ENTITY</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.R_FEED">R_FEED</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.R_SUB">R_SUB</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.logger">logger</a></li>
  </ul>

    </li>


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#IoticAgent.IOT.Client.Client">Client</a></span>
        
          
  <ul>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.__init__">__init__</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.confirm_tell">confirm_tell</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.create_thing">create_thing</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.create_thing_async">create_thing_async</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.delete_thing">delete_thing</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.delete_thing_async">delete_thing_async</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.describe">describe</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.get_thing">get_thing</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.is_connected">is_connected</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.list">list</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.register_callback_created">register_callback_created</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.register_callback_deleted">register_callback_deleted</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.register_callback_duplicate">register_callback_duplicate</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.register_callback_reassigned">register_callback_reassigned</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.register_callback_renamed">register_callback_renamed</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.register_callback_subscribed">register_callback_subscribed</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.register_callback_subscription">register_callback_subscription</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.register_catchall_controlreq">register_catchall_controlreq</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.register_catchall_feeddata">register_catchall_feeddata</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.save_config">save_config</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.search">search</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.search_located">search_located</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.search_reduced">search_reduced</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.simulate_feeddata">simulate_feeddata</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.start">start</a></li>
    <li class="mono"><a href="#IoticAgent.IOT.Client.Client.stop">stop</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">IoticAgent.IOT.Client</span> module</h1>
  <p>The Client object used to initiate connection to Iotic Space</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client" class="source">
    <div class="codehilite"><pre><span></span><span class="c1"># Copyright (c) 2016 Iotic Labs Ltd. All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     https://github.com/Iotic-Labs/py-IoticAgent/blob/master/LICENSE</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="sd">&quot;&quot;&quot;The Client object used to initiate connection to Iotic Space</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>

<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">warn</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">DEBUG_ENABLED</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">IoticAgent.Core</span> <span class="kn">import</span> <span class="n">Client</span> <span class="k">as</span> <span class="n">Core_Client</span><span class="p">,</span> <span class="n">ThreadSafeDict</span><span class="p">,</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">Core_Version</span>
<span class="kn">from</span> <span class="nn">IoticAgent.Core.compat</span> <span class="kn">import</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">raise_from</span><span class="p">,</span> <span class="n">string_types</span>
<span class="kn">from</span> <span class="nn">IoticAgent.Core.Const</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">E_FAILED_CODE_NOTALLOWED</span><span class="p">,</span> <span class="n">E_FAILED_CODE_UNKNOWN</span><span class="p">,</span> <span class="n">E_FAILED_CODE_MALFORMED</span><span class="p">,</span> <span class="n">E_FAILED_CODE_INTERNALERROR</span><span class="p">,</span>
    <span class="n">E_FAILED_CODE_ACCESSDENIED</span><span class="p">,</span>
    <span class="n">M_CLIENTREF</span><span class="p">,</span> <span class="n">M_PAYLOAD</span><span class="p">,</span>
    <span class="n">R_ENTITY</span><span class="p">,</span> <span class="n">R_FEED</span><span class="p">,</span> <span class="n">R_CONTROL</span><span class="p">,</span> <span class="n">R_SUB</span><span class="p">,</span>
    <span class="n">P_CODE</span><span class="p">,</span> <span class="n">P_ID</span><span class="p">,</span> <span class="n">P_LID</span><span class="p">,</span> <span class="n">P_ENTITY_LID</span><span class="p">,</span> <span class="n">P_EPID</span><span class="p">,</span> <span class="n">P_RESOURCE</span><span class="p">,</span> <span class="n">P_MESSAGE</span><span class="p">,</span> <span class="n">P_POINT_TYPE</span><span class="p">,</span> <span class="n">P_POINT_ID</span><span class="p">,</span> <span class="n">P_DATA</span><span class="p">,</span>
    <span class="n">SearchScope</span><span class="p">,</span> <span class="n">SearchType</span><span class="p">,</span> <span class="n">DescribeScope</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">IoticAgent.Core.utils</span> <span class="kn">import</span> <span class="n">validate_nonnegative_int</span>
<span class="kn">from</span> <span class="nn">IoticAgent.Core.Validation</span> <span class="kn">import</span> <span class="n">Validation</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">__version__</span>
<span class="kn">from</span> <span class="nn">.Thing</span> <span class="kn">import</span> <span class="n">Thing</span>
<span class="kn">from</span> <span class="nn">.Config</span> <span class="kn">import</span> <span class="n">Config</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">uuid_to_hex</span><span class="p">,</span> <span class="n">version_string_to_tuple</span><span class="p">,</span> <span class="n">bool_from</span><span class="p">,</span> <span class="n">foc_to_str</span>
<span class="kn">from</span> <span class="nn">.Exceptions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">IOTException</span><span class="p">,</span> <span class="n">IOTUnknown</span><span class="p">,</span> <span class="n">IOTMalformed</span><span class="p">,</span> <span class="n">IOTInternalError</span><span class="p">,</span> <span class="n">IOTAccessDenied</span><span class="p">,</span> <span class="n">IOTClientError</span><span class="p">,</span> <span class="n">IOTSyncTimeout</span><span class="p">,</span>
    <span class="n">IOTNotAllowed</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">.Point</span> <span class="kn">import</span> <span class="n">Control</span><span class="p">,</span> <span class="n">Point</span><span class="p">,</span> <span class="n">_POINT_TYPES</span>
<span class="kn">from</span> <span class="nn">.RemotePoint</span> <span class="kn">import</span> <span class="n">RemoteFeed</span><span class="p">,</span> <span class="n">RemoteControl</span>
<span class="kn">from</span> <span class="nn">.PointValueHelper</span> <span class="kn">import</span> <span class="n">PointDataObjectHandler</span><span class="p">,</span> <span class="n">RefreshException</span>


<span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>  <span class="c1"># pylint: disable=too-many-public-methods, too-many-lines</span>

    <span class="c1"># Core version targeted by IOT client</span>
    <span class="n">__core_version</span> <span class="o">=</span> <span class="s1">&#39;0.6.8&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an IOT.Client instance which provides access to Iotic Space</span>

<span class="sd">        `config` (optional): The name of the config file containing the connection parameters.</span>
<span class="sd">        Defaults to the name of the script +&quot;.ini&quot;, e.g. `config=&quot;my_script.ini&quot;`. Alternatively</span>
<span class="sd">        an existing [Config](Config.m.html#IoticAgent.IOT.Config.Config) object can be specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__core_version_check</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;IOT version: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">__version__</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">string_types</span><span class="p">)</span> <span class="ow">or</span> <span class="n">config</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">Config</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;config should be string or Config instance&#39;</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">,</span> <span class="s1">&#39;epid&#39;</span><span class="p">,</span> <span class="s1">&#39;passwd&#39;</span><span class="p">,</span> <span class="s1">&#39;token&#39;</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Minimum configuration for IoticAgent is host, epid, passwd and token</span><span class="se">\n</span><span class="s1">&#39;</span>
                             <span class="s1">&#39;Create file &quot;</span><span class="si">%s</span><span class="s1">&quot; with contents</span><span class="se">\n</span><span class="s1">[agent]</span><span class="se">\n</span><span class="s1">host = w</span><span class="se">\n</span><span class="s1">epid = x</span><span class="se">\n</span><span class="s1">passwd = y</span><span class="se">\n</span><span class="s1">token = z&#39;</span>
                             <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">_file_loc</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__sync_timeout</span> <span class="o">=</span> <span class="n">validate_nonnegative_int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;iot&#39;</span><span class="p">,</span> <span class="s1">&#39;sync_request_timeout&#39;</span><span class="p">),</span>
                                                       <span class="s1">&#39;iot.sync_request_timeout&#39;</span><span class="p">,</span> <span class="n">allow_zero</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">setup_logging</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__client</span> <span class="o">=</span> <span class="n">Core_Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">),</span>
                                        <span class="n">vhost</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;vhost&#39;</span><span class="p">),</span>
                                        <span class="n">epId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;epid&#39;</span><span class="p">),</span>
                                        <span class="n">lang</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;lang&#39;</span><span class="p">),</span>
                                        <span class="n">passwd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;passwd&#39;</span><span class="p">),</span>
                                        <span class="n">token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;token&#39;</span><span class="p">),</span>
                                        <span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;prefix&#39;</span><span class="p">),</span>
                                        <span class="n">sslca</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;sslca&#39;</span><span class="p">),</span>
                                        <span class="n">network_retry_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;network_retry_timeout&#39;</span><span class="p">),</span>
                                        <span class="n">socket_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;socket_timeout&#39;</span><span class="p">),</span>
                                        <span class="n">auto_encode_decode</span><span class="o">=</span><span class="n">bool_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;auto_encode_decode&#39;</span><span class="p">),</span>
                                                                     <span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
                                        <span class="n">send_queue_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;queue_size&#39;</span><span class="p">),</span>
                                        <span class="n">throttle_conf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;throttle&#39;</span><span class="p">),</span>
                                        <span class="n">max_encoded_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;max_encoded_length&#39;</span><span class="p">),</span>
                                        <span class="n">startup_ignore_exc</span><span class="o">=</span><span class="n">bool_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;startup_ignore_exc&#39;</span><span class="p">),</span>
                                                                     <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">raise_from</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Configuration error&#39;</span><span class="p">),</span> <span class="n">ex</span><span class="p">)</span>

        <span class="c1">#</span>
        <span class="c1"># Callbacks for updating own resource cache (used internally only)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_created</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_created</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_duplicate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_duplicated</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_reassigned</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_reassigned</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_deleted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_deleted</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_recent_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_recent_data</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Keeps track of newly created things (the requests for which originated from this agent)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span> <span class="o">=</span> <span class="n">ThreadSafeDict</span><span class="p">()</span>
        <span class="c1"># Allows client to forward e.g. Point creation callbacks to the relevant Thing instance. This contains the most</span>
        <span class="c1"># recent instance of any single Thing (since creation requests can be performed more than once).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span> <span class="o">=</span> <span class="n">ThreadSafeDict</span><span class="p">()</span>
        <span class="c1"># PointDataObjectHandler cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__point_data_handlers</span> <span class="o">=</span> <span class="n">ThreadSafeDict</span><span class="p">()</span>
        <span class="c1"># recent data callbacks by request id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span> <span class="o">=</span> <span class="n">ThreadSafeDict</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">agent_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Agent id (aka epId) in use for this client instance&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">epId</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">default_lang</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Language in use when not explicitly specified (in meta related requests). Will be set to container default</span>
<span class="sd">        if was not set in configuration. Before client has started this might be None.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">default_lang</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">local_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whether container-local metadata functionality (e.g. search) is available in this container. Before calling</span>
<span class="sd">        start() this will always be False.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">local_meta</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open a connection to Iotic Space.  `start()` is called by `__enter__` which allows the python</span>
<span class="sd">        `with` syntax to be used.</span>

<span class="sd">        `Example 0` - Calling start() implicitly using with.  minimal example with no exception handling</span>

<span class="sd">            #!python</span>
<span class="sd">            with IOT.Client(config=&quot;my_script.ini&quot;) as client:</span>
<span class="sd">                client.create_thing(&quot;my_thing&quot;)</span>

<span class="sd">        `Example 1` - Calling start() implicitly using with.  This handles the finally for you. `Recommended`</span>

<span class="sd">            #!python</span>
<span class="sd">            try:</span>
<span class="sd">                with IOT.Client(config=&quot;my_script.ini&quot;) as client:</span>
<span class="sd">                    try:</span>
<span class="sd">                        client.create_thing(&quot;my_thing&quot;)</span>
<span class="sd">                    except IOTException as exc:</span>
<span class="sd">                        # handle exception</span>
<span class="sd">            except Exception as exc:  # not possible to connect</span>
<span class="sd">                print(exc)</span>
<span class="sd">                import sys</span>
<span class="sd">                sys.exit(1)</span>

<span class="sd">        `Example 2` - Calling start() explicitly (no with)  Be careful, you have to put a finally in your try blocks</span>
<span class="sd">        otherwise your client might remain connected.</span>

<span class="sd">            #!python</span>
<span class="sd">            try:</span>
<span class="sd">                client = IOT.Client(config=&quot;my_script.ini&quot;)</span>
<span class="sd">                # wire up callbacks here</span>
<span class="sd">                client.start()</span>
<span class="sd">            except Exception as exc:</span>
<span class="sd">                print(exc)</span>
<span class="sd">                import sys</span>
<span class="sd">                sys.exit(1)</span>

<span class="sd">            try:</span>
<span class="sd">                client.create_thing(&quot;my_thing&quot;)</span>
<span class="sd">            except IOTException as exc:</span>
<span class="sd">                # handle individual exception</span>
<span class="sd">            finally:</span>
<span class="sd">                client.stop()</span>

<span class="sd">        Returns This Client instance</span>

<span class="sd">        Raises Exception</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close the connection to Iotic Space.  `stop()` is called by `__exit()__` allowing the python `with`</span>
<span class="sd">        syntax to be used.  See [start()](#IoticAgent.IOT.Client.Client.start)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="c1"># Don&#39;t want on ignored exceptions</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sync_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Value of iot.sync_request_timeout configuration option. Used by all synchronous requests to limit total</span>
<span class="sd">        request wait time.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__sync_timeout</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">__core_version_check</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">core</span> <span class="o">=</span> <span class="n">version_string_to_tuple</span><span class="p">(</span><span class="n">Core_Version</span><span class="p">)</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="n">version_string_to_tuple</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">__core_version</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">core</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">expected</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Core client dependency major version difference: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1"> expected)&#39;</span> <span class="o">%</span>
                               <span class="p">(</span><span class="n">Core_Version</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__core_version</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">core</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">expected</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Core client minor version old: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1"> known)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Core_Version</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__core_version</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">core</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">expected</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Core client minor version difference: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1"> known)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Core_Version</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__core_version</span><span class="p">),</span>
                 <span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">core</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">expected</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Core client patch level change: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1"> known)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Core_Version</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__core_version</span><span class="p">),</span>
                 <span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Core version: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Core_Version</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_notify_thing_lid_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_lid</span><span class="p">,</span> <span class="n">to_lid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Used by Thing instances to indicate that a rename operation has happened&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">[</span><span class="n">to_lid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_lid</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Thing </span><span class="si">%s</span><span class="s1"> renamed (to </span><span class="si">%s</span><span class="s1">), but not in private lookup table&#39;</span><span class="p">,</span> <span class="n">from_lid</span><span class="p">,</span> <span class="n">to_lid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># renaming could happen before get_thing is called on the original</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">[</span><span class="n">to_lid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_lid</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns client&#39;s alive state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">register_catchall_feeddata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers a callback that is called for all feeddata your Thing receives</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def feeddata_callback(data):</span>
<span class="sd">                print(data)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_catchall_feeddata(feeddata_callback)</span>

<span class="sd">        `callback` (required) the function name that you want to be called on receipt of new feed data</span>

<span class="sd">        `callback_parsed` (optional) (function reference) callback function to invoke on receipt of feed data. This is</span>
<span class="sd">        equivalent to `callback` except the dict includes the `parsed` key which holds the set of values in a</span>
<span class="sd">        [PointDataObject](./Point.m.html#IoticAgent.IOT.Point.PointDataObject) instance. If both</span>
<span class="sd">        `callback_parsed` and `callback` have been specified, the former takes precedence and `callback` is only called</span>
<span class="sd">        if the point data could not be parsed according to its current value description.</span>

<span class="sd">        `NOTE`: `callback_parsed` can only be used if `auto_encode_decode` is enabled for the client instance.</span>

<span class="sd">        More details on the contents of the `data` dictionary for feeds see:</span>
<span class="sd">        [follow()](./Thing.m.html#IoticAgent.IOT.Thing.Thing.follow)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">callback_parsed</span><span class="p">:</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_parsed_feed_callback</span><span class="p">(</span><span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_feeddata</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_catchall_controlreq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers a callback that is called for all control requests received by your Thing</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def controlreq_callback(data):</span>
<span class="sd">                print(data)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_catchall_controlreq(controlreq_callback)</span>

<span class="sd">        `callback` (required) the function name that you want to be called on receipt of a new control request</span>


<span class="sd">        `callback_parsed` (optional) (function reference) callback function to invoke on receipt of a control ask/tell.</span>
<span class="sd">        This is equivalent to `callback` except the dict includes the `parsed` key which holds the set of values in a</span>
<span class="sd">        [PointDataObject](./Point.m.html#IoticAgent.IOT.Point.PointDataObject) instance. If both `callback_parsed` and</span>
<span class="sd">        `callback` have been specified, the former takes precedence and `callback` is only called if the point data</span>
<span class="sd">        could not be parsed according to its current value description.</span>

<span class="sd">        More details on the contents of the `data` dictionary for controls see:</span>
<span class="sd">        [create_control()](./Thing.m.html#IoticAgent.IOT.Thing.Thing.create_control)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">callback_parsed</span><span class="p">:</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_parsed_control_callback</span><span class="p">(</span><span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_controlreq</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_callback_subscription</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for subscription count change notification.  This gets called whenever something *else*</span>
<span class="sd">        subscribes to your thing.</span>

<span class="sd">        `Note` it is not called when you subscribe to something else.</span>

<span class="sd">        The payload passed to your callback is an OrderedDict with the following keys</span>

<span class="sd">            #!python</span>
<span class="sd">            r         : R_FEED or R_CONTROL # the type of the point</span>
<span class="sd">            lid       : &lt;name&gt;              # the local name of your *Point*</span>
<span class="sd">            entityLid : &lt;name&gt;              # the local name of your *Thing*</span>
<span class="sd">            subCount  : &lt;count&gt;             # the total number of remote Things</span>
<span class="sd">                                            # that subscribe to your point</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def subscription_callback(args):</span>
<span class="sd">                print(args)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_callback_subscription(subscription_callback)</span>

<span class="sd">        This would print out something like the following</span>

<span class="sd">            #!python</span>
<span class="sd">            OrderedDict([(&#39;r&#39;, 2), (&#39;lid&#39;, &#39;My_First_Point&#39;),</span>
<span class="sd">                         (&#39;entityLid&#39;, &#39;My_First_Thing&#39;), (&#39;subCount&#39;, 13)])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_subscription</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">__callback_payload_only</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="c1"># Only pass the payload to callback</span>
        <span class="n">callback</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">M_PAYLOAD</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">register_callback_created</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for resource creation.  This will be called when any *new* resource</span>
<span class="sd">        is created within your agent.  If `serialised` is not set, the callbacks might arrive</span>
<span class="sd">        in a different order to they were requested.</span>

<span class="sd">        The payload passed to your callback is an OrderedDict with the following keys</span>

<span class="sd">            #!python</span>
<span class="sd">            r         : R_ENTITY, R_FEED, etc # the type of resource created</span>
<span class="sd">            lid       : &lt;name&gt;                # the local name of the resource</span>
<span class="sd">            id        : &lt;GUID&gt;                # the global Id of the resource</span>
<span class="sd">            epId      : &lt;GUID&gt;                # the global Id of your agent</span>

<span class="sd">        `Note` resource types are defined [here](../Core/Const.m.html)</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def created_callback(args):</span>
<span class="sd">                print(args)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_callback_created(created_callback)</span>

<span class="sd">        This would print out something like the following on creation of an R_ENTITY</span>

<span class="sd">            #!python</span>
<span class="sd">            OrderedDict([(u&#39;lid&#39;, u&#39;new_thing1&#39;), (u&#39;r&#39;, 1),</span>
<span class="sd">                         (u&#39;epId&#39;, u&#39;ffd47b75ea786f55c76e337cdc47665a&#39;),</span>
<span class="sd">                         (u&#39;id&#39;, u&#39;3f11df0a09588a6a1a9732e3837765f8&#39;)]))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_created</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="o">=</span><span class="n">serialised</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_callback_duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for resource creation but where the resource already exists in Iotic Space.</span>
<span class="sd">        In this case the existing reference is passed to you.</span>
<span class="sd">        If `serialised` is not set, the callbacks might arrive in a different order to they were requested.</span>

<span class="sd">        The payload passed to your callback is an OrderedDict with the following keys</span>

<span class="sd">            #!python</span>
<span class="sd">            r         : R_ENTITY, R_FEED, etc # the type of existing resource</span>
<span class="sd">            lid       : &lt;name&gt;                # the local name of the</span>
<span class="sd">                                              # existing resource</span>
<span class="sd">            id        : &lt;GUID&gt;                # the global Id of the</span>
<span class="sd">                                              # existing resource</span>
<span class="sd">            epId      : &lt;GUID&gt;                # the global Id of your agent</span>

<span class="sd">        `Note` resource types are defined [here](../Core/Const.m.html)</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def duplicated_callback(args):</span>
<span class="sd">                print(args)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_callback_created(duplicated_callback)</span>

<span class="sd">        This would print out something like the following on re-creation of an R_ENTITY</span>

<span class="sd">            #!python</span>
<span class="sd">            OrderedDict([(u&#39;lid&#39;, u&#39;new_thing1&#39;), (u&#39;r&#39;, 1),</span>
<span class="sd">                         (u&#39;epId&#39;, u&#39;ffd47b75ea786f55c76e337cdc47665a&#39;),</span>
<span class="sd">                         (u&#39;id&#39;, u&#39;3f11df0a09588a6a1a9732e3837765f8&#39;)]))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_duplicate</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="o">=</span><span class="n">serialised</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_callback_renamed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for resource rename.  This will be called when any resource</span>
<span class="sd">        is renamed within your agent.</span>
<span class="sd">        If `serialised` is not set, the callbacks might arrive in a different order to they were requested.</span>

<span class="sd">        The payload passed to your callback is an OrderedDict with the following keys</span>

<span class="sd">            #!python</span>
<span class="sd">            r         : R_ENTITY, R_FEED, etc # the type of resource deleted</span>
<span class="sd">            lid       : &lt;name&gt;                # the new local name of the resource</span>
<span class="sd">            oldLid    : &lt;name&gt;                # the old local name of the resource</span>
<span class="sd">            id        : &lt;GUID&gt;                # the global Id of the resource</span>

<span class="sd">        `Note` resource types are defined [here](../Core/Const.m.html)</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def renamed_callback(args):</span>
<span class="sd">                print(args)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_callback_renamed(renamed_callback)</span>

<span class="sd">        This would print out something like the following on renaming of an R_ENTITY</span>

<span class="sd">            #!python</span>
<span class="sd">            OrderedDict([(u&#39;lid&#39;, u&#39;new_name&#39;),</span>
<span class="sd">                         (u&#39;r&#39;, 1),</span>
<span class="sd">                         (u&#39;oldLid&#39;, u&#39;old_name&#39;),</span>
<span class="sd">                         (u&#39;id&#39;, u&#39;4448993b44738411de5fe2a6cf32d957&#39;)])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_renamed</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="o">=</span><span class="n">serialised</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_callback_deleted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for resource deletion.  This will be called when any resource</span>
<span class="sd">        is deleted within your agent.</span>
<span class="sd">        If `serialised` is not set, the callbacks might arrive in a different order to they were requested.</span>

<span class="sd">        The payload passed to your callback is an OrderedDict with the following keys</span>

<span class="sd">            #!python</span>
<span class="sd">            r         : R_ENTITY, R_FEED, etc # the type of resource deleted</span>
<span class="sd">            lid       : &lt;name&gt;                # the local name of the resource</span>
<span class="sd">            id        : &lt;GUID&gt;                # the global Id of the resource</span>

<span class="sd">        `Note` resource types are defined [here](../Core/Const.m.html)</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def deleted_callback(args):</span>
<span class="sd">                print(args)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_callback_deleted(deleted_callback)</span>

<span class="sd">        This would print out something like the following on deletion of an R_ENTITY</span>

<span class="sd">            #!python</span>
<span class="sd">            OrderedDict([(u&#39;lid&#39;, u&#39;old_thing1&#39;),</span>
<span class="sd">                         (u&#39;r&#39;, 1),</span>
<span class="sd">                         (u&#39;id&#39;, u&#39;315637813d801ec6f057c67728bf00c2&#39;)])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_deleted</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="o">=</span><span class="n">serialised</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_callback_reassigned</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for resource reassignment.  This will be called when any resource</span>
<span class="sd">        is reassigned to or from your agent.</span>
<span class="sd">        If `serialised` is not set, the callbacks might arrive in a different order to they were requested.</span>

<span class="sd">        The payload passed to your callback is an OrderedDict with the following keys</span>

<span class="sd">            #!python</span>
<span class="sd">            r         : R_ENTITY, R_FEED, etc # the type of resource reassigned</span>
<span class="sd">            lid       : &lt;name&gt;                # the local name of the resource</span>
<span class="sd">            epId      : &lt;GUID&gt;                # the global Id of the agent the</span>
<span class="sd">                                              # resource has been reassigned *to*</span>
<span class="sd">            id        : &lt;GUID&gt;                # the global Id of the resource</span>

<span class="sd">        `Note` resource types are defined [here](../Core/Const.m.html)</span>

<span class="sd">        `Note` You can check whether this is an assign &quot;in&quot; or &quot;out&quot; by comparing the epId with your current</span>
<span class="sd">        agent id, using the `IOT.Client.agent_id` property.  If it&#39;s the same it&#39;s a reassign to you.</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def reassigned_callback(args):</span>
<span class="sd">                print(args)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_callback_reassigned(reassigned_callback)</span>

<span class="sd">        This would print out something like the following on assignment of an R_ENTITY to</span>

<span class="sd">            #!python</span>
<span class="sd">            OrderedDict([(u&#39;lid&#39;, u&#39;moved_thing&#39;),</span>
<span class="sd">                         (u&#39;r&#39;, 1),</span>
<span class="sd">                         (u&#39;epId&#39;, u&#39;5a8d603ee757133d66d99875d0584c72&#39;),</span>
<span class="sd">                         (u&#39;id&#39;, u&#39;4448993b44738411de5fe2a6cf32d957&#39;)])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_reassigned</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__callback_subscribed_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_PAYLOAD</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="o">==</span> <span class="n">R_SUB</span><span class="p">:</span>
            <span class="bp">cls</span> <span class="o">=</span> <span class="n">RemoteFeed</span> <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_POINT_TYPE</span><span class="p">]</span> <span class="o">==</span> <span class="n">R_FEED</span> <span class="k">else</span> <span class="n">RemoteControl</span>
            <span class="n">callback</span><span class="p">(</span><span class="bp">cls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_ID</span><span class="p">],</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_POINT_ID</span><span class="p">],</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">register_callback_subscribed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for new subscription. This gets called whenever one of *your* things subscribes to something</span>
<span class="sd">        else.</span>

<span class="sd">        `Note` it is not called when whenever something else subscribes to your thing.</span>

<span class="sd">        The payload passed to your callback is either a</span>
<span class="sd">        [RemoteControl](RemotePoint.m.html#IoticAgent.IOT.RemotePoint.RemoteControl) or</span>
<span class="sd">        [RemoteFeed](RemotePoint.m.html#IoticAgent.IOT.RemotePoint.RemoteFeed) instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_created</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_subscribed_filter</span><span class="p">,</span> <span class="n">callback</span><span class="p">),</span>
                                                       <span class="n">serialised</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">simulate_feeddata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feedid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Simulate the last feeddata received for given feedid</span>
<span class="sd">        Calls the registered callback for the feed with the last recieved feed data. Allows you to test your code</span>
<span class="sd">        without having to wait for the remote thing to share again.</span>

<span class="sd">        `feedid` (required) (string) local id of your Feed</span>

<span class="sd">        `data` (optional) (as applicable) The data you want to use to simulate the arrival of remote feed data</span>

<span class="sd">        `mime` (optional) (string) The mime type of your data. See also:</span>
<span class="sd">        [share()](./Point.m.html#IoticAgent.IOT.Point.Feed.share)</span>

<span class="sd">        `time` (optional) (datetime) UTC timestamp for share. See also:</span>
<span class="sd">        [share()](./Point.m.html#IoticAgent.IOT.Point.Feed.share)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">simulate_feeddata</span><span class="p">(</span><span class="n">feedid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># todo: simulate_controlreq -- needs last data and Point instance</span>
    <span class="c1">#</span>

    <span class="k">def</span> <span class="nf">confirm_tell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">success</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Confirm that you&#39;ve done as you were told.  Call this from your control callback to confirm action.</span>
<span class="sd">        Used when you are advertising a control and you want to tell the remote requestor that you have</span>
<span class="sd">        done what they asked you to.</span>

<span class="sd">        `Example:` this is a minimal example to show the idea.  Note - no Exception handling and ugly use of globals</span>

<span class="sd">            #!python</span>
<span class="sd">            client = None</span>

<span class="sd">            def controlreq_cb(args):</span>
<span class="sd">                global client   # the client object you connected with</span>

<span class="sd">                # perform your action with the data they sent</span>
<span class="sd">                success = do_control_action(args[&#39;data&#39;])</span>

<span class="sd">                if args[&#39;confirm&#39;]:  # you&#39;ve been asked to confirm</span>
<span class="sd">                    client.confirm_tell(args, success)</span>
<span class="sd">                # else, if you do not confirm_tell() this causes a timeout at the requestor&#39;s end.</span>

<span class="sd">            client = IOT.Client(config=&#39;test.ini&#39;)</span>
<span class="sd">            thing = client.create_thing(&#39;test321&#39;)</span>
<span class="sd">            control = thing.create_control(&#39;control&#39;, controlreq_cb)</span>

<span class="sd">        Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">        containing the error if the infrastructure detects a problem</span>

<span class="sd">        Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">        if there is a communications problem between you and the infrastructure</span>

<span class="sd">        `data` (mandatory) (dictionary)  The `&quot;args&quot;` dictionary that your callback was called with</span>

<span class="sd">        `success` (mandatory) (boolean)  Whether or not the action you have been asked to do has been</span>
<span class="sd">        sucessful.</span>

<span class="sd">        More details on the contents of the `data` dictionary for controls see:</span>
<span class="sd">        [create_control()](./Thing.m.html#IoticAgent.IOT.Thing.Thing.create_control)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;confirm_tell(success=</span><span class="si">%s</span><span class="s2">) [lid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">,pid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="n">success</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">P_LID</span><span class="p">])</span>
        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_point_confirm_tell</span><span class="p">(</span><span class="n">R_CONTROL</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">P_LID</span><span class="p">],</span> <span class="n">success</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;requestId&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the config, update the seqnum &amp; default language</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;seqnum&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">get_seqnum</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;lang&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">default_lang</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_parsed_feed_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="n">Validation</span><span class="o">.</span><span class="n">callable_check</span><span class="p">(</span><span class="n">callback_parsed</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parsed_callback_wrapper</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">R_FEED</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_parsed_control_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="n">Validation</span><span class="o">.</span><span class="n">callable_check</span><span class="p">(</span><span class="n">callback_parsed</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parsed_callback_wrapper</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">R_CONTROL</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_point_data_handler_for</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Used by point instances and data callbacks&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__point_data_handlers</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__point_data_handlers</span><span class="p">[</span><span class="n">point</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__point_data_handlers</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">PointDataObjectHandler</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_parsed_callback_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback_plain</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Used to by register_catchall_*data() and Thing class (follow, create_point) to present point data as an</span>
<span class="sd">        object.&quot;&quot;&quot;</span>
        <span class="c1"># used by PointDataObjectHandler as reference</span>
        <span class="k">if</span> <span class="n">foc</span> <span class="o">==</span> <span class="n">R_FEED</span><span class="p">:</span>
            <span class="n">point_ref</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pid&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># R_CONTROL</span>
            <span class="n">point_ref</span> <span class="o">=</span> <span class="n">Control</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">P_LID</span><span class="p">],</span> <span class="s1">&#39;0&#39;</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;parsed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_point_data_handler_for</span><span class="p">(</span><span class="n">point_ref</span><span class="p">)</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">P_DATA</span><span class="p">])</span>
        <span class="k">except</span> <span class="n">RefreshException</span><span class="p">:</span>
            <span class="c1"># No metadata available, do not produce warning</span>
            <span class="k">if</span> <span class="n">callback_plain</span><span class="p">:</span>
                <span class="n">callback_plain</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Failed to parse </span><span class="si">%s</span><span class="s1"> data for </span><span class="si">%s%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">foc_to_str</span><span class="p">(</span><span class="n">foc</span><span class="p">),</span> <span class="n">point_ref</span><span class="p">,</span>
                           <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">callback_plain</span> <span class="k">else</span> <span class="s1">&#39;, ignoring&#39;</span><span class="p">,</span>
                           <span class="n">exc_info</span><span class="o">=</span><span class="n">DEBUG_ENABLED</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">callback_plain</span><span class="p">:</span>
                <span class="n">callback_plain</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">callback_parsed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">__exception_mapping</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">E_FAILED_CODE_ACCESSDENIED</span><span class="p">:</span> <span class="n">IOTAccessDenied</span><span class="p">,</span>
        <span class="n">E_FAILED_CODE_INTERNALERROR</span><span class="p">:</span> <span class="n">IOTInternalError</span><span class="p">,</span>
        <span class="n">E_FAILED_CODE_MALFORMED</span><span class="p">:</span> <span class="n">IOTMalformed</span><span class="p">,</span>
        <span class="n">E_FAILED_CODE_NOTALLOWED</span><span class="p">:</span> <span class="n">IOTNotAllowed</span><span class="p">,</span>
        <span class="n">E_FAILED_CODE_UNKNOWN</span><span class="p">:</span> <span class="n">IOTUnknown</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_wait_and_except_if_failed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Combines waiting for event and call to `_except_if_failed`.&quot;&quot;&quot;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__sync_timeout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_except_if_failed</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_except_if_failed</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Raises an IOTException from the given event if it was not successful. Assumes timeout success flag on event</span>
<span class="sd">        has not been set yet.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">success</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">IOTSyncTimeout</span><span class="p">(</span><span class="s1">&#39;Requested timed out&#39;</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">event</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Request failed, unknown error&quot;</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">payload</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">P_MESSAGE</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">payload</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="n">P_MESSAGE</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">exc_class</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__exception_mapping</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="n">P_CODE</span><span class="p">]]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">exc_class</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>

            <span class="k">raise</span> <span class="n">IOTException</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_my_agents</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;List `all` the things created by this client on this or all your agents</span>

<span class="sd">        Returns QAPI list function payload</span>

<span class="sd">        Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">        if there is a communications problem between you and the infrastructure</span>

<span class="sd">        `all_my_agents` (optional) (boolean) If `False` limit search to just this agent,</span>
<span class="sd">        if `True` return list of things belonging to all agents you own.</span>

<span class="sd">        `limit` (optional) (integer) Return this many Point details</span>

<span class="sd">        `offset` (optional) (integer) Return Point details starting at this offset</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;list(all_my_agents=</span><span class="si">%s</span><span class="s2">, limit=</span><span class="si">%s</span><span class="s2">, offset=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">all_my_agents</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">all_my_agents</span><span class="p">:</span>
            <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_entity_list_all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_entity_list</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">evt</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;entities&#39;</span><span class="p">]</span>  <span class="c1"># pylint:disable=unsubscriptable-object</span>

    <span class="k">def</span> <span class="nf">get_thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the details of a newly created Thing. This only applies to asynchronous creation of Things and the</span>
<span class="sd">        new Thing instance can only be retrieved once.</span>

<span class="sd">        Returns a [Thing](Thing.m.html#IoticAgent.IOT.Thing.Thing) object,</span>
<span class="sd">        which corresponds to the Thing with the given local id (nickname)</span>

<span class="sd">        Raises `KeyError` if the Thing has not been newly created (or has already been retrieved by a previous call)</span>

<span class="sd">        `lid` (required) (string) local identifier of your Thing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                <span class="n">raise_from</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Thing </span><span class="si">%s</span><span class="s1"> not know as new&#39;</span> <span class="o">%</span> <span class="n">lid</span><span class="p">),</span> <span class="n">ex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new Thing with a local id (lid).</span>

<span class="sd">        Returns a [Thing](Thing.m.html#IoticAgent.IOT.Thing.Thing)  object if successful</span>
<span class="sd">        or if the Thing already exists</span>

<span class="sd">        Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">        containing the error if the infrastructure detects a problem</span>

<span class="sd">        Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">        if there is a communications problem between you and the infrastructure</span>

<span class="sd">        `lid` (required) (string) local identifier of your Thing.  The local id is your name or nickname for the thing.</span>
<span class="sd">        It&#39;s &quot;local&quot; in that it&#39;s only available to you on this container, not searchable and not visible to others.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_thing_async</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">raise_from</span><span class="p">(</span><span class="n">IOTClientError</span><span class="p">(</span><span class="s1">&#39;Thing </span><span class="si">%s</span><span class="s1"> not in cache (post-create)&#39;</span> <span class="o">%</span> <span class="n">lid</span><span class="p">),</span> <span class="n">ex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_thing_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;create_thing(lid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">lid</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_entity_create</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a Thing</span>

<span class="sd">        Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">        containing the error if the infrastructure detects a problem</span>

<span class="sd">        Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">        if there is a communications problem between you and the infrastructure</span>

<span class="sd">        `lid` (required) (string) local identifier of the Thing you want to delete</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;delete_thing(lid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">lid</span><span class="p">)</span>
        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_thing_async</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_thing_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;delete_thing(lid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">lid</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_entity_delete</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">reduced</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">scope</span><span class="o">=</span><span class="n">SearchScope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Search the Iotic Space for public Things with metadata matching the search parameters:</span>
<span class="sd">        text, lang(uage), location, unit, limit, offset. Note that only things which have at least one point defined can</span>
<span class="sd">        be found.</span>

<span class="sd">        Returns dict of results as below (first with reduced=False, second with reduced=True)- OR -</span>

<span class="sd">            #!python</span>
<span class="sd">            # reduced=False returns dict similar to below</span>
<span class="sd">            {</span>
<span class="sd">                &quot;2b2d8b068e404861b19f9e060877e002&quot;: {</span>
<span class="sd">                    &quot;long&quot;: -1.74803,</span>
<span class="sd">                    &quot;matches&quot;: 3.500,</span>
<span class="sd">                    &quot;lat&quot;: 52.4539,</span>
<span class="sd">                    &quot;label&quot;: &quot;Weather Station #2&quot;,</span>
<span class="sd">                    &quot;owner&quot;: &quot;3bbf307b43b1460289fe707619dece3d&quot;,</span>
<span class="sd">                    &quot;points&quot;: {</span>
<span class="sd">                        &quot;a300cc90147f4e2990195639de0af201&quot;: {</span>
<span class="sd">                            &quot;matches&quot;: 3.000,</span>
<span class="sd">                            &quot;label&quot;: &quot;Feed 201&quot;,</span>
<span class="sd">                            &quot;type&quot;: &quot;Feed&quot;,</span>
<span class="sd">                            &quot;storesRecent&quot;: true</span>
<span class="sd">                        },</span>
<span class="sd">                        &quot;a300cc90147f4e2990195639de0af202&quot;: {</span>
<span class="sd">                            &quot;matches&quot;: 1.500,</span>
<span class="sd">                            &quot;label&quot;: &quot;Feed 202&quot;,</span>
<span class="sd">                            &quot;type&quot;: &quot;Feed&quot;,</span>
<span class="sd">                            &quot;storesRecent&quot;: false</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                },</span>
<span class="sd">                &quot;76a3b24b02d34f20b675257624b0e001&quot;: {</span>
<span class="sd">                    &quot;long&quot;: 0.716356,</span>
<span class="sd">                    &quot;matches&quot;: 2.000,</span>
<span class="sd">                    &quot;lat&quot;: 52.244384,</span>
<span class="sd">                    &quot;label&quot;: &quot;Weather Station #1&quot;,</span>
<span class="sd">                    &quot;owner&quot;: &quot;3bbf307b43b1460289fe707619dece3d&quot;,</span>
<span class="sd">                    &quot;points&quot;: {</span>
<span class="sd">                        &quot;fb1a4a4dbb2642ab9f836892da93f101&quot;: {</span>
<span class="sd">                            &quot;matches&quot;: 1.000,</span>
<span class="sd">                            &quot;label&quot;: &quot;My weather feed&quot;,</span>
<span class="sd">                            &quot;type&quot;: &quot;Feed&quot;,</span>
<span class="sd">                            &quot;storesRecent&quot;: false</span>
<span class="sd">                        },</span>
<span class="sd">                        &quot;fb1a4a4dbb2642ab9f836892da93c102&quot;: {</span>
<span class="sd">                            &quot;matches&quot;: 1.000,</span>
<span class="sd">                            &quot;label&quot;: None,</span>
<span class="sd">                            &quot;type&quot;: &quot;Control&quot;,</span>
<span class="sd">                            &quot;storesRecent&quot;: false</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            }</span>

<span class="sd">            # reduced=True returns dict similar to below</span>
<span class="sd">            {</span>
<span class="sd">                &quot;2b2d8b068e404861b19f9e060877e002&quot;: {</span>
<span class="sd">                    &quot;a300cc90147f4e2990195639de0af201&quot;: &quot;Feed&quot;,</span>
<span class="sd">                    &quot;a300cc90147f4e2990195639de0af202&quot;: &quot;Feed&quot;</span>
<span class="sd">                },</span>
<span class="sd">                &quot;76a3b24b02d34f20b675257624b0e001&quot;: {</span>
<span class="sd">                    &quot;fb1a4a4dbb2642ab9f836892da93f101&quot;: &quot;Feed&quot;,</span>
<span class="sd">                    &quot;fb1a4a4dbb2642ab9f836892da93f102&quot;: &quot;Control&quot;</span>
<span class="sd">                }</span>
<span class="sd">            }</span>

<span class="sd">        Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">        containing the error if the infrastructure detects a problem</span>

<span class="sd">        Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">        if there is a communications problem between you and the infrastructure</span>

<span class="sd">        `text` (optional) (string) The text to search for. Label and description will be searched</span>
<span class="sd">        for both Thing and Point and each word will be used as a tag search too. Text search is case-insensitive. Tag</span>
<span class="sd">        search is language neutral.</span>

<span class="sd">        `lang` (optional) (string) The two-character ISO 639-1 language code to search in, e.g. &quot;en&quot; &quot;fr&quot;</span>
<span class="sd">        Language is used to limit search to only labels and descriptions in that language. You will only get labels `in</span>
<span class="sd">        that language` back from search and then only if there are any in that language.</span>

<span class="sd">        `location` (optional) (dictionary) Latitude, longitude and radius to search within.</span>
<span class="sd">        All values are float, Radius is in kilometers (km). E.g. `{&quot;lat&quot;=1.2345, &quot;long&quot;=54.321, &quot;radius&quot;=6.789}`. Note:</span>
<span class="sd">        If `text` has not been specified, radius can at most be 25km.</span>

<span class="sd">        `unit` (optional) (string) Valid URL of a unit in an ontology.  Or use a constant from the</span>
<span class="sd">        [units](../Units.m.html#IoticAgent.Units) class - such as [METRE](../Units.m.html#IoticAgent.Units.METRE).</span>

<span class="sd">        `limit` (optional) (integer) Return this many search results.</span>

<span class="sd">        `offset` (optional) (integer) Return results starting at this offset - good for paging.</span>

<span class="sd">        `reduced` (optional) (boolean) If `true`, return the reduced results just containing points and</span>
<span class="sd">        their type.</span>

<span class="sd">        `local` (optional) (boolean) **Deprecated**, use `scope` instead. If `true`, perform search at container level.</span>
<span class="sd">        Check the local_meta flag to determine whether local metadata functionality is available. (Takes precedence over</span>
<span class="sd">        `scope`.)</span>

<span class="sd">        `scope` (optional) ([SearchScope](../Core/Const.m.html#IoticAgent.Core.Const.SearchScope)) Whether to perform</span>
<span class="sd">        PUBLIC, LOCAL (container level) or LOCAL_OWN (container level restricted to own things) search. Check the</span>
<span class="sd">        [local_meta](#IoticAgent.IOT.Client.Client.local_meta) flag to determine whether local metadata functionality is</span>
<span class="sd">        available. (Note that PUBLIC and LOCAL_OWN scopes are always available.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;search(text=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, lang=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, location=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, unit=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, limit=</span><span class="si">%s</span><span class="s2">, offset=</span><span class="si">%s</span><span class="s2">, reduced=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">reduced</span><span class="p">)</span>
        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_search</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>
                                   <span class="n">SearchType</span><span class="o">.</span><span class="n">REDUCED</span> <span class="k">if</span> <span class="n">reduced</span> <span class="k">else</span> <span class="n">SearchType</span><span class="o">.</span><span class="n">FULL</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">evt</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>  <span class="c1"># pylint: disable=unsubscriptable-object</span>

    <span class="k">def</span> <span class="nf">search_reduced</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">scope</span><span class="o">=</span><span class="n">SearchScope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shorthand for [search()](#IoticAgent.IOT.Client.Client.search) with `reduced=True`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">reduced</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="n">scope</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">search_located</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">scope</span><span class="o">=</span><span class="n">SearchScope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See [search()](#IoticAgent.IOT.Client.Client.search) for general documentation. Provides a thing-only</span>
<span class="sd">        result set comprised only of things which have a location set, e.g.:</span>

<span class="sd">            #!python</span>
<span class="sd">            {</span>
<span class="sd">                # Keyed by thing id</span>
<span class="sd">                &#39;2b2d8b068e404861b19f9e060877e002&#39;:</span>
<span class="sd">                    # location (g, lat &amp; long), label (l, optional)</span>
<span class="sd">                    {&#39;g&#39;: (52.4539, -1.74803), &#39;l&#39;: &#39;Weather Station #2&#39;},</span>
<span class="sd">                &#39;76a3b24b02d34f20b675257624b0e001&#39;:</span>
<span class="sd">                    {&#39;g&#39;: (52.244384, 0.716356), &#39;l&#39;: None},</span>
<span class="sd">                &#39;76a3b24b02d34f20b675257624b0e004&#39;:</span>
<span class="sd">                    {&#39;g&#39;: (52.245384, 0.717356), &#39;l&#39;: &#39;Gasometer&#39;},</span>
<span class="sd">                &#39;76a3b24b02d34f20b675257624b0e005&#39;:</span>
<span class="sd">                    {&#39;g&#39;: (52.245384, 0.717356), &#39;l&#39;: &#39;Zepellin&#39;}</span>
<span class="sd">            }</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;search_located(text=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, lang=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, location=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, unit=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, limit=</span><span class="si">%s</span><span class="s2">, offset=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_search</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">SearchType</span><span class="o">.</span><span class="n">LOCATED</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">evt</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>  <span class="c1"># pylint: disable=unsubscriptable-object</span>

    <span class="c1"># used by describe()</span>
    <span class="n">__guid_resources</span> <span class="o">=</span> <span class="p">(</span><span class="n">Thing</span><span class="p">,</span> <span class="n">Point</span><span class="p">,</span> <span class="n">RemoteFeed</span><span class="p">,</span> <span class="n">RemoteControl</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guid_or_resource</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="n">DescribeScope</span><span class="o">.</span><span class="n">AUTO</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Describe returns the public (or local) description of a Thing or Point</span>

<span class="sd">        Returns the description dict (see below for Thing example) if available, otherwise `None`</span>

<span class="sd">            #!python</span>
<span class="sd">            {</span>
<span class="sd">                &quot;type&quot;: &quot;Entity&quot;,</span>
<span class="sd">                &quot;meta&quot;: {</span>
<span class="sd">                    &quot;long&quot;: 0.716356,</span>
<span class="sd">                    &quot;lat&quot;: 52.244384,</span>
<span class="sd">                    &quot;label&quot;: &quot;Weather Station #1&quot;,</span>
<span class="sd">                    &quot;parent&quot;: &quot;3bbf307b43b1460289fe707619dece3d&quot;,</span>
<span class="sd">                    &quot;points&quot;: [</span>
<span class="sd">                        {</span>
<span class="sd">                            &quot;type&quot;: &quot;Control&quot;,</span>
<span class="sd">                            &quot;label&quot;: &quot;Control 101&quot;,</span>
<span class="sd">                            &quot;guid&quot;: &quot;fb1a4a4dbb2642ab9f836892da93c101&quot;,</span>
<span class="sd">                            &quot;storesRecent&quot;: false</span>
<span class="sd">                        },</span>
<span class="sd">                        {</span>
<span class="sd">                            &quot;type&quot;: &quot;Feed&quot;,</span>
<span class="sd">                            &quot;label&quot;: &quot;My weather feed&quot;,</span>
<span class="sd">                            &quot;guid&quot;: &quot;fb1a4a4dbb2642ab9f836892da93f101&quot;,</span>
<span class="sd">                            &quot;storesRecent&quot;: true</span>
<span class="sd">                        }</span>
<span class="sd">                    ],</span>
<span class="sd">                    &quot;comment&quot;: &quot;A lovely weather station...&quot;,</span>
<span class="sd">                    &quot;tags&quot;: [</span>
<span class="sd">                        &quot;blue&quot;,</span>
<span class="sd">                        &quot;garden&quot;</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            }</span>

<span class="sd">        Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">        containing the error if the infrastructure detects a problem</span>

<span class="sd">        Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">        if there is a communications problem between you and the infrastructure</span>

<span class="sd">        `guid_or_resource` (mandatory) (string or object).</span>
<span class="sd">        If a `string`, it should contain the globally unique id of the resource you want to describe in 8-4-4-4-12</span>
<span class="sd">        (or undashed) format.</span>
<span class="sd">        If an `object`, it should be an instance of Thing, Point, RemoteFeed or RemoteControl.  The system will return</span>
<span class="sd">        you the description of that object.</span>

<span class="sd">        `lang` (optional) (string) The two-character ISO 639-1 language code for which labels and comments will be</span>
<span class="sd">        returned. This does not affect Values (i.e. when describing a Point, apart from value comments) and tags as</span>
<span class="sd">        these are language neutral).</span>

<span class="sd">        `local` (optional) (boolean) **Deprecated**, use `scope` instead. If `true`, lookup metadata at container level.</span>
<span class="sd">        Check the local_meta flag to determine whether local metadata functionality is available. (Takes precedence over</span>
<span class="sd">        `scope`.)</span>

<span class="sd">        `scope` (optional) ([DescribeScope](../Core/Const.m.html#IoticAgent.Core.Const.DescribeScope)) Whether to</span>
<span class="sd">        perform PUBLIC, LOCAL (container level) or LOCAL_OWN (container level restricted to own things) metadata lookup.</span>
<span class="sd">        Check the [local_meta](#IoticAgent.IOT.Client.Client.local_meta) flag to determine whether local metadata</span>
<span class="sd">        functionality is available. (Note that AUTO, PUBLIC and LOCAL_OWN scopes are always available.). AUTO mode</span>
<span class="sd">        first attempts to look up private metadata, then public.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">guid_or_resource</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__guid_resources</span><span class="p">):</span>
            <span class="n">guid</span> <span class="o">=</span> <span class="n">guid_or_resource</span><span class="o">.</span><span class="n">guid</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">guid_or_resource</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
            <span class="n">guid</span> <span class="o">=</span> <span class="n">uuid_to_hex</span><span class="p">(</span><span class="n">guid_or_resource</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;describe requires guid string or Thing, Point, RemoteFeed or RemoteControl instance&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;describe() [guid=&quot;</span><span class="si">%s</span><span class="s1">&quot;]&#39;</span><span class="p">,</span> <span class="n">guid</span><span class="p">)</span>

        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_describe</span><span class="p">(</span><span class="n">guid</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">evt</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>  <span class="c1"># pylint: disable=unsubscriptable-object</span>

    <span class="k">def</span> <span class="nf">__cb_created</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">duplicated</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="c1"># Only consider solicitied creation events since there is no cache. This also applies to things reassigned to</span>
        <span class="c1"># this agent.</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_PAYLOAD</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_CLIENTREF</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="o">==</span> <span class="n">R_ENTITY</span><span class="p">:</span>
                <span class="n">lid</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_LID</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_EPID</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">epId</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Created thing </span><span class="si">%s</span><span class="s1"> assigned to different agent: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_EPID</span><span class="p">])</span>
                <span class="n">thing</span> <span class="o">=</span> <span class="n">Thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_ID</span><span class="p">],</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_EPID</span><span class="p">])</span>

                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">[</span><span class="n">lid</span><span class="p">]</span> <span class="o">=</span> <span class="n">thing</span>
                <span class="c1"># second (permanent) reference kept so can forward to thing for e.g. point creation callbacks</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">[</span><span class="n">lid</span><span class="p">]</span> <span class="o">=</span> <span class="n">thing</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Added </span><span class="si">%s</span><span class="s1">thing: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="s1">&#39;existing &#39;</span> <span class="k">if</span> <span class="n">duplicated</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_ID</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="ow">in</span> <span class="n">_POINT_TYPES</span> <span class="ow">or</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="o">==</span> <span class="n">R_SUB</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">:</span>
                    <span class="n">thing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">],</span> <span class="bp">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">thing</span><span class="p">:</span>
                    <span class="n">thing</span><span class="o">.</span><span class="n">_cb_created</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">duplicated</span><span class="o">=</span><span class="n">duplicated</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Thing </span><span class="si">%s</span><span class="s1"> unknown internally, ignoring creation of point/sub&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Resource creation of type </span><span class="si">%d</span><span class="s1"> unhandled&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Ignoring unsolicited creation request of type </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__cb_duplicated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__cb_created</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">duplicated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__cb_reassigned</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_PAYLOAD</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="o">==</span> <span class="n">R_ENTITY</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">:</span>
                <span class="n">thing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="n">P_LID</span><span class="p">],</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">thing</span><span class="p">:</span>
                <span class="n">thing</span><span class="o">.</span><span class="n">_cb_reassigned</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Thing </span><span class="si">%s</span><span class="s1"> unknown internally, ignoring reassignment&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_LID</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Resource reassignment of type </span><span class="si">%d</span><span class="s1"> unhandled&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__cb_deleted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="c1"># only consider solicitied deletion events</span>
        <span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_CLIENTREF</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_PAYLOAD</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="o">==</span> <span class="n">R_ENTITY</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="n">P_LID</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Deleted thing </span><span class="si">%s</span><span class="s1"> unknown internally&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_LID</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Deleted thing: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_LID</span><span class="p">])</span>

            <span class="c1"># currently no functionality benefits from these</span>
            <span class="k">elif</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">R_FEED</span><span class="p">,</span> <span class="n">R_CONTROL</span><span class="p">,</span> <span class="n">R_SUB</span><span class="p">):</span>
                <span class="k">pass</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Resource deletetion of type </span><span class="si">%d</span><span class="s1"> unhandled&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Ignoring unsolicited deletion request of type </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_PAYLOAD</span><span class="p">][</span><span class="n">P_RESOURCE</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__cb_recent_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># determine specific callback</span>
                <span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">M_CLIENTREF</span><span class="p">]]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;No callback for recent data request with id </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">M_CLIENTREF</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">callback</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Recent data callback failed for point </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">P_POINT_ID</span><span class="p">],</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">DEBUG_ENABLED</span><span class="p">)</span>

    <span class="c1"># Registrer specific callback function (for a recent data callback) which will be removed on request completion. The</span>
    <span class="c1"># request is NOT checked first.</span>
    <span class="k">def</span> <span class="nf">_add_recent_cb_for</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span><span class="p">[</span><span class="n">req</span><span class="o">.</span><span class="n">id_</span><span class="p">]</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__recent_cb_per_sample</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
        <span class="n">req</span><span class="o">.</span><span class="n">_run_on_completion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__remove_recent_cb_for</span><span class="p">)</span>

    <span class="c1"># multi-sample to per-sample callback wrapper</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__recent_cb_per_sample</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;samples&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
            <span class="n">func</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

    <span class="c1"># used by _add_recent_cb_for only</span>
    <span class="k">def</span> <span class="nf">__remove_recent_cb_for</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">id_</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;recent cb does not exist for request </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">req</span><span class="o">.</span><span class="n">id_</span><span class="p">)</span>

    <span class="c1"># Wrap Core.Client functions so IOT contains everything.</span>
    <span class="c1"># These are protected functions used by Client, Thing, Point etc.</span>
    <span class="k">def</span> <span class="nf">_request_point_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_list</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_list_detailed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_list_detailed</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_recent_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_recent_info</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_recent_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_recent_config</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">max_samples</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_list</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_list_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_list_all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_create</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">new_lid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_rename</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">new_lid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_delete</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_reassign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">new_epid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_reassign</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">new_epid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_meta_setpublic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">public</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_meta_setpublic</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">public</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_tag_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_tag_update</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">delete</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_tag_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_tag_list</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_meta_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_meta_get</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_meta_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">rdf</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_meta_set</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">rdf</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">control_cb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">save_recent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_create</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">control_cb</span><span class="p">,</span> <span class="n">save_recent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">newpid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_rename</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">newpid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_delete</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_share</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_share</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_confirm_tell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">success</span><span class="p">,</span> <span class="n">requestId</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_confirm_tell</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">success</span><span class="p">,</span> <span class="n">requestId</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_meta_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_meta_get</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_meta_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">rdf</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_meta_set</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">rdf</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_tag_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_tag_update</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">delete</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_tag_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_tag_list</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_value_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">vtype</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_value_create</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">vtype</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_value_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_value_delete</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_value_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_value_list</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_create_local</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_create_local</span><span class="p">(</span><span class="n">slid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">gpid</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_create</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">gpid</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_ask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_ask</span><span class="p">(</span><span class="n">subid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_tell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">mime</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_tell</span><span class="p">(</span><span class="n">subid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">mime</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_delete</span><span class="p">(</span><span class="n">subid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_list</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_recent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_id</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_recent</span><span class="p">(</span><span class="n">sub_id</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">scope</span><span class="o">=</span><span class="n">SearchScope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_search</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_describe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guid</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="n">DescribeScope</span><span class="o">.</span><span class="n">AUTO</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_describe</span><span class="p">(</span><span class="n">guid</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="IoticAgent.IOT.Client.Core_Version" class="name">var <span class="ident">Core_Version</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.DEBUG_ENABLED" class="name">var <span class="ident">DEBUG_ENABLED</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.E_FAILED_CODE_ACCESSDENIED" class="name">var <span class="ident">E_FAILED_CODE_ACCESSDENIED</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.E_FAILED_CODE_INTERNALERROR" class="name">var <span class="ident">E_FAILED_CODE_INTERNALERROR</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.E_FAILED_CODE_MALFORMED" class="name">var <span class="ident">E_FAILED_CODE_MALFORMED</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.E_FAILED_CODE_NOTALLOWED" class="name">var <span class="ident">E_FAILED_CODE_NOTALLOWED</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.E_FAILED_CODE_UNKNOWN" class="name">var <span class="ident">E_FAILED_CODE_UNKNOWN</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.M_CLIENTREF" class="name">var <span class="ident">M_CLIENTREF</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.M_PAYLOAD" class="name">var <span class="ident">M_PAYLOAD</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.P_CODE" class="name">var <span class="ident">P_CODE</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.P_DATA" class="name">var <span class="ident">P_DATA</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.P_ENTITY_LID" class="name">var <span class="ident">P_ENTITY_LID</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.P_EPID" class="name">var <span class="ident">P_EPID</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.P_ID" class="name">var <span class="ident">P_ID</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.P_LID" class="name">var <span class="ident">P_LID</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.P_MESSAGE" class="name">var <span class="ident">P_MESSAGE</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.P_POINT_ID" class="name">var <span class="ident">P_POINT_ID</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.P_POINT_TYPE" class="name">var <span class="ident">P_POINT_TYPE</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.P_RESOURCE" class="name">var <span class="ident">P_RESOURCE</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.R_CONTROL" class="name">var <span class="ident">R_CONTROL</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.R_ENTITY" class="name">var <span class="ident">R_ENTITY</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.R_FEED" class="name">var <span class="ident">R_FEED</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.R_SUB" class="name">var <span class="ident">R_SUB</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="IoticAgent.IOT.Client.logger" class="name">var <span class="ident">logger</span></p>
      
  
  <div class="source_cont">
</div>

      </div>


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="IoticAgent.IOT.Client.Client" class="name">class <span class="ident">Client</span></p>
      
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>  <span class="c1"># pylint: disable=too-many-public-methods, too-many-lines</span>

    <span class="c1"># Core version targeted by IOT client</span>
    <span class="n">__core_version</span> <span class="o">=</span> <span class="s1">&#39;0.6.8&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an IOT.Client instance which provides access to Iotic Space</span>

<span class="sd">        `config` (optional): The name of the config file containing the connection parameters.</span>
<span class="sd">        Defaults to the name of the script +&quot;.ini&quot;, e.g. `config=&quot;my_script.ini&quot;`. Alternatively</span>
<span class="sd">        an existing [Config](Config.m.html#IoticAgent.IOT.Config.Config) object can be specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__core_version_check</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;IOT version: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">__version__</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">string_types</span><span class="p">)</span> <span class="ow">or</span> <span class="n">config</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">Config</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;config should be string or Config instance&#39;</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">,</span> <span class="s1">&#39;epid&#39;</span><span class="p">,</span> <span class="s1">&#39;passwd&#39;</span><span class="p">,</span> <span class="s1">&#39;token&#39;</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Minimum configuration for IoticAgent is host, epid, passwd and token</span><span class="se">\n</span><span class="s1">&#39;</span>
                             <span class="s1">&#39;Create file &quot;</span><span class="si">%s</span><span class="s1">&quot; with contents</span><span class="se">\n</span><span class="s1">[agent]</span><span class="se">\n</span><span class="s1">host = w</span><span class="se">\n</span><span class="s1">epid = x</span><span class="se">\n</span><span class="s1">passwd = y</span><span class="se">\n</span><span class="s1">token = z&#39;</span>
                             <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">_file_loc</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__sync_timeout</span> <span class="o">=</span> <span class="n">validate_nonnegative_int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;iot&#39;</span><span class="p">,</span> <span class="s1">&#39;sync_request_timeout&#39;</span><span class="p">),</span>
                                                       <span class="s1">&#39;iot.sync_request_timeout&#39;</span><span class="p">,</span> <span class="n">allow_zero</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">setup_logging</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__client</span> <span class="o">=</span> <span class="n">Core_Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">),</span>
                                        <span class="n">vhost</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;vhost&#39;</span><span class="p">),</span>
                                        <span class="n">epId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;epid&#39;</span><span class="p">),</span>
                                        <span class="n">lang</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;lang&#39;</span><span class="p">),</span>
                                        <span class="n">passwd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;passwd&#39;</span><span class="p">),</span>
                                        <span class="n">token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;token&#39;</span><span class="p">),</span>
                                        <span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;prefix&#39;</span><span class="p">),</span>
                                        <span class="n">sslca</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;sslca&#39;</span><span class="p">),</span>
                                        <span class="n">network_retry_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;network_retry_timeout&#39;</span><span class="p">),</span>
                                        <span class="n">socket_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;socket_timeout&#39;</span><span class="p">),</span>
                                        <span class="n">auto_encode_decode</span><span class="o">=</span><span class="n">bool_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;auto_encode_decode&#39;</span><span class="p">),</span>
                                                                     <span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
                                        <span class="n">send_queue_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;queue_size&#39;</span><span class="p">),</span>
                                        <span class="n">throttle_conf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;throttle&#39;</span><span class="p">),</span>
                                        <span class="n">max_encoded_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;max_encoded_length&#39;</span><span class="p">),</span>
                                        <span class="n">startup_ignore_exc</span><span class="o">=</span><span class="n">bool_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;startup_ignore_exc&#39;</span><span class="p">),</span>
                                                                     <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">raise_from</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Configuration error&#39;</span><span class="p">),</span> <span class="n">ex</span><span class="p">)</span>

        <span class="c1">#</span>
        <span class="c1"># Callbacks for updating own resource cache (used internally only)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_created</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_created</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_duplicate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_duplicated</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_reassigned</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_reassigned</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_deleted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_deleted</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_recent_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_recent_data</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Keeps track of newly created things (the requests for which originated from this agent)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span> <span class="o">=</span> <span class="n">ThreadSafeDict</span><span class="p">()</span>
        <span class="c1"># Allows client to forward e.g. Point creation callbacks to the relevant Thing instance. This contains the most</span>
        <span class="c1"># recent instance of any single Thing (since creation requests can be performed more than once).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span> <span class="o">=</span> <span class="n">ThreadSafeDict</span><span class="p">()</span>
        <span class="c1"># PointDataObjectHandler cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__point_data_handlers</span> <span class="o">=</span> <span class="n">ThreadSafeDict</span><span class="p">()</span>
        <span class="c1"># recent data callbacks by request id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span> <span class="o">=</span> <span class="n">ThreadSafeDict</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">agent_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Agent id (aka epId) in use for this client instance&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">epId</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">default_lang</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Language in use when not explicitly specified (in meta related requests). Will be set to container default</span>
<span class="sd">        if was not set in configuration. Before client has started this might be None.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">default_lang</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">local_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whether container-local metadata functionality (e.g. search) is available in this container. Before calling</span>
<span class="sd">        start() this will always be False.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">local_meta</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open a connection to Iotic Space.  `start()` is called by `__enter__` which allows the python</span>
<span class="sd">        `with` syntax to be used.</span>

<span class="sd">        `Example 0` - Calling start() implicitly using with.  minimal example with no exception handling</span>

<span class="sd">            #!python</span>
<span class="sd">            with IOT.Client(config=&quot;my_script.ini&quot;) as client:</span>
<span class="sd">                client.create_thing(&quot;my_thing&quot;)</span>

<span class="sd">        `Example 1` - Calling start() implicitly using with.  This handles the finally for you. `Recommended`</span>

<span class="sd">            #!python</span>
<span class="sd">            try:</span>
<span class="sd">                with IOT.Client(config=&quot;my_script.ini&quot;) as client:</span>
<span class="sd">                    try:</span>
<span class="sd">                        client.create_thing(&quot;my_thing&quot;)</span>
<span class="sd">                    except IOTException as exc:</span>
<span class="sd">                        # handle exception</span>
<span class="sd">            except Exception as exc:  # not possible to connect</span>
<span class="sd">                print(exc)</span>
<span class="sd">                import sys</span>
<span class="sd">                sys.exit(1)</span>

<span class="sd">        `Example 2` - Calling start() explicitly (no with)  Be careful, you have to put a finally in your try blocks</span>
<span class="sd">        otherwise your client might remain connected.</span>

<span class="sd">            #!python</span>
<span class="sd">            try:</span>
<span class="sd">                client = IOT.Client(config=&quot;my_script.ini&quot;)</span>
<span class="sd">                # wire up callbacks here</span>
<span class="sd">                client.start()</span>
<span class="sd">            except Exception as exc:</span>
<span class="sd">                print(exc)</span>
<span class="sd">                import sys</span>
<span class="sd">                sys.exit(1)</span>

<span class="sd">            try:</span>
<span class="sd">                client.create_thing(&quot;my_thing&quot;)</span>
<span class="sd">            except IOTException as exc:</span>
<span class="sd">                # handle individual exception</span>
<span class="sd">            finally:</span>
<span class="sd">                client.stop()</span>

<span class="sd">        Returns This Client instance</span>

<span class="sd">        Raises Exception</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close the connection to Iotic Space.  `stop()` is called by `__exit()__` allowing the python `with`</span>
<span class="sd">        syntax to be used.  See [start()](#IoticAgent.IOT.Client.Client.start)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="c1"># Don&#39;t want on ignored exceptions</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sync_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Value of iot.sync_request_timeout configuration option. Used by all synchronous requests to limit total</span>
<span class="sd">        request wait time.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__sync_timeout</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">__core_version_check</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">core</span> <span class="o">=</span> <span class="n">version_string_to_tuple</span><span class="p">(</span><span class="n">Core_Version</span><span class="p">)</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="n">version_string_to_tuple</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">__core_version</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">core</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">expected</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Core client dependency major version difference: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1"> expected)&#39;</span> <span class="o">%</span>
                               <span class="p">(</span><span class="n">Core_Version</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__core_version</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">core</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">expected</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Core client minor version old: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1"> known)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Core_Version</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__core_version</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">core</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">expected</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Core client minor version difference: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1"> known)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Core_Version</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__core_version</span><span class="p">),</span>
                 <span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">core</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">expected</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Core client patch level change: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1"> known)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Core_Version</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__core_version</span><span class="p">),</span>
                 <span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Core version: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Core_Version</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_notify_thing_lid_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_lid</span><span class="p">,</span> <span class="n">to_lid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Used by Thing instances to indicate that a rename operation has happened&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">[</span><span class="n">to_lid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_lid</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Thing </span><span class="si">%s</span><span class="s1"> renamed (to </span><span class="si">%s</span><span class="s1">), but not in private lookup table&#39;</span><span class="p">,</span> <span class="n">from_lid</span><span class="p">,</span> <span class="n">to_lid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># renaming could happen before get_thing is called on the original</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">[</span><span class="n">to_lid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">from_lid</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns client&#39;s alive state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">register_catchall_feeddata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers a callback that is called for all feeddata your Thing receives</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def feeddata_callback(data):</span>
<span class="sd">                print(data)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_catchall_feeddata(feeddata_callback)</span>

<span class="sd">        `callback` (required) the function name that you want to be called on receipt of new feed data</span>

<span class="sd">        `callback_parsed` (optional) (function reference) callback function to invoke on receipt of feed data. This is</span>
<span class="sd">        equivalent to `callback` except the dict includes the `parsed` key which holds the set of values in a</span>
<span class="sd">        [PointDataObject](./Point.m.html#IoticAgent.IOT.Point.PointDataObject) instance. If both</span>
<span class="sd">        `callback_parsed` and `callback` have been specified, the former takes precedence and `callback` is only called</span>
<span class="sd">        if the point data could not be parsed according to its current value description.</span>

<span class="sd">        `NOTE`: `callback_parsed` can only be used if `auto_encode_decode` is enabled for the client instance.</span>

<span class="sd">        More details on the contents of the `data` dictionary for feeds see:</span>
<span class="sd">        [follow()](./Thing.m.html#IoticAgent.IOT.Thing.Thing.follow)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">callback_parsed</span><span class="p">:</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_parsed_feed_callback</span><span class="p">(</span><span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_feeddata</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_catchall_controlreq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers a callback that is called for all control requests received by your Thing</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def controlreq_callback(data):</span>
<span class="sd">                print(data)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_catchall_controlreq(controlreq_callback)</span>

<span class="sd">        `callback` (required) the function name that you want to be called on receipt of a new control request</span>


<span class="sd">        `callback_parsed` (optional) (function reference) callback function to invoke on receipt of a control ask/tell.</span>
<span class="sd">        This is equivalent to `callback` except the dict includes the `parsed` key which holds the set of values in a</span>
<span class="sd">        [PointDataObject](./Point.m.html#IoticAgent.IOT.Point.PointDataObject) instance. If both `callback_parsed` and</span>
<span class="sd">        `callback` have been specified, the former takes precedence and `callback` is only called if the point data</span>
<span class="sd">        could not be parsed according to its current value description.</span>

<span class="sd">        More details on the contents of the `data` dictionary for controls see:</span>
<span class="sd">        [create_control()](./Thing.m.html#IoticAgent.IOT.Thing.Thing.create_control)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">callback_parsed</span><span class="p">:</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_parsed_control_callback</span><span class="p">(</span><span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_controlreq</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_callback_subscription</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for subscription count change notification.  This gets called whenever something *else*</span>
<span class="sd">        subscribes to your thing.</span>

<span class="sd">        `Note` it is not called when you subscribe to something else.</span>

<span class="sd">        The payload passed to your callback is an OrderedDict with the following keys</span>

<span class="sd">            #!python</span>
<span class="sd">            r         : R_FEED or R_CONTROL # the type of the point</span>
<span class="sd">            lid       : &lt;name&gt;              # the local name of your *Point*</span>
<span class="sd">            entityLid : &lt;name&gt;              # the local name of your *Thing*</span>
<span class="sd">            subCount  : &lt;count&gt;             # the total number of remote Things</span>
<span class="sd">                                            # that subscribe to your point</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def subscription_callback(args):</span>
<span class="sd">                print(args)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_callback_subscription(subscription_callback)</span>

<span class="sd">        This would print out something like the following</span>

<span class="sd">            #!python</span>
<span class="sd">            OrderedDict([(&#39;r&#39;, 2), (&#39;lid&#39;, &#39;My_First_Point&#39;),</span>
<span class="sd">                         (&#39;entityLid&#39;, &#39;My_First_Thing&#39;), (&#39;subCount&#39;, 13)])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_subscription</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">__callback_payload_only</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="c1"># Only pass the payload to callback</span>
        <span class="n">callback</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">M_PAYLOAD</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">register_callback_created</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for resource creation.  This will be called when any *new* resource</span>
<span class="sd">        is created within your agent.  If `serialised` is not set, the callbacks might arrive</span>
<span class="sd">        in a different order to they were requested.</span>

<span class="sd">        The payload passed to your callback is an OrderedDict with the following keys</span>

<span class="sd">            #!python</span>
<span class="sd">            r         : R_ENTITY, R_FEED, etc # the type of resource created</span>
<span class="sd">            lid       : &lt;name&gt;                # the local name of the resource</span>
<span class="sd">            id        : &lt;GUID&gt;                # the global Id of the resource</span>
<span class="sd">            epId      : &lt;GUID&gt;                # the global Id of your agent</span>

<span class="sd">        `Note` resource types are defined [here](../Core/Const.m.html)</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def created_callback(args):</span>
<span class="sd">                print(args)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_callback_created(created_callback)</span>

<span class="sd">        This would print out something like the following on creation of an R_ENTITY</span>

<span class="sd">            #!python</span>
<span class="sd">            OrderedDict([(u&#39;lid&#39;, u&#39;new_thing1&#39;), (u&#39;r&#39;, 1),</span>
<span class="sd">                         (u&#39;epId&#39;, u&#39;ffd47b75ea786f55c76e337cdc47665a&#39;),</span>
<span class="sd">                         (u&#39;id&#39;, u&#39;3f11df0a09588a6a1a9732e3837765f8&#39;)]))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_created</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="o">=</span><span class="n">serialised</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_callback_duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for resource creation but where the resource already exists in Iotic Space.</span>
<span class="sd">        In this case the existing reference is passed to you.</span>
<span class="sd">        If `serialised` is not set, the callbacks might arrive in a different order to they were requested.</span>

<span class="sd">        The payload passed to your callback is an OrderedDict with the following keys</span>

<span class="sd">            #!python</span>
<span class="sd">            r         : R_ENTITY, R_FEED, etc # the type of existing resource</span>
<span class="sd">            lid       : &lt;name&gt;                # the local name of the</span>
<span class="sd">                                              # existing resource</span>
<span class="sd">            id        : &lt;GUID&gt;                # the global Id of the</span>
<span class="sd">                                              # existing resource</span>
<span class="sd">            epId      : &lt;GUID&gt;                # the global Id of your agent</span>

<span class="sd">        `Note` resource types are defined [here](../Core/Const.m.html)</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def duplicated_callback(args):</span>
<span class="sd">                print(args)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_callback_created(duplicated_callback)</span>

<span class="sd">        This would print out something like the following on re-creation of an R_ENTITY</span>

<span class="sd">            #!python</span>
<span class="sd">            OrderedDict([(u&#39;lid&#39;, u&#39;new_thing1&#39;), (u&#39;r&#39;, 1),</span>
<span class="sd">                         (u&#39;epId&#39;, u&#39;ffd47b75ea786f55c76e337cdc47665a&#39;),</span>
<span class="sd">                         (u&#39;id&#39;, u&#39;3f11df0a09588a6a1a9732e3837765f8&#39;)]))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_duplicate</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="o">=</span><span class="n">serialised</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_callback_renamed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for resource rename.  This will be called when any resource</span>
<span class="sd">        is renamed within your agent.</span>
<span class="sd">        If `serialised` is not set, the callbacks might arrive in a different order to they were requested.</span>

<span class="sd">        The payload passed to your callback is an OrderedDict with the following keys</span>

<span class="sd">            #!python</span>
<span class="sd">            r         : R_ENTITY, R_FEED, etc # the type of resource deleted</span>
<span class="sd">            lid       : &lt;name&gt;                # the new local name of the resource</span>
<span class="sd">            oldLid    : &lt;name&gt;                # the old local name of the resource</span>
<span class="sd">            id        : &lt;GUID&gt;                # the global Id of the resource</span>

<span class="sd">        `Note` resource types are defined [here](../Core/Const.m.html)</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def renamed_callback(args):</span>
<span class="sd">                print(args)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_callback_renamed(renamed_callback)</span>

<span class="sd">        This would print out something like the following on renaming of an R_ENTITY</span>

<span class="sd">            #!python</span>
<span class="sd">            OrderedDict([(u&#39;lid&#39;, u&#39;new_name&#39;),</span>
<span class="sd">                         (u&#39;r&#39;, 1),</span>
<span class="sd">                         (u&#39;oldLid&#39;, u&#39;old_name&#39;),</span>
<span class="sd">                         (u&#39;id&#39;, u&#39;4448993b44738411de5fe2a6cf32d957&#39;)])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_renamed</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="o">=</span><span class="n">serialised</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_callback_deleted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for resource deletion.  This will be called when any resource</span>
<span class="sd">        is deleted within your agent.</span>
<span class="sd">        If `serialised` is not set, the callbacks might arrive in a different order to they were requested.</span>

<span class="sd">        The payload passed to your callback is an OrderedDict with the following keys</span>

<span class="sd">            #!python</span>
<span class="sd">            r         : R_ENTITY, R_FEED, etc # the type of resource deleted</span>
<span class="sd">            lid       : &lt;name&gt;                # the local name of the resource</span>
<span class="sd">            id        : &lt;GUID&gt;                # the global Id of the resource</span>

<span class="sd">        `Note` resource types are defined [here](../Core/Const.m.html)</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def deleted_callback(args):</span>
<span class="sd">                print(args)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_callback_deleted(deleted_callback)</span>

<span class="sd">        This would print out something like the following on deletion of an R_ENTITY</span>

<span class="sd">            #!python</span>
<span class="sd">            OrderedDict([(u&#39;lid&#39;, u&#39;old_thing1&#39;),</span>
<span class="sd">                         (u&#39;r&#39;, 1),</span>
<span class="sd">                         (u&#39;id&#39;, u&#39;315637813d801ec6f057c67728bf00c2&#39;)])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_deleted</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="o">=</span><span class="n">serialised</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_callback_reassigned</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for resource reassignment.  This will be called when any resource</span>
<span class="sd">        is reassigned to or from your agent.</span>
<span class="sd">        If `serialised` is not set, the callbacks might arrive in a different order to they were requested.</span>

<span class="sd">        The payload passed to your callback is an OrderedDict with the following keys</span>

<span class="sd">            #!python</span>
<span class="sd">            r         : R_ENTITY, R_FEED, etc # the type of resource reassigned</span>
<span class="sd">            lid       : &lt;name&gt;                # the local name of the resource</span>
<span class="sd">            epId      : &lt;GUID&gt;                # the global Id of the agent the</span>
<span class="sd">                                              # resource has been reassigned *to*</span>
<span class="sd">            id        : &lt;GUID&gt;                # the global Id of the resource</span>

<span class="sd">        `Note` resource types are defined [here](../Core/Const.m.html)</span>

<span class="sd">        `Note` You can check whether this is an assign &quot;in&quot; or &quot;out&quot; by comparing the epId with your current</span>
<span class="sd">        agent id, using the `IOT.Client.agent_id` property.  If it&#39;s the same it&#39;s a reassign to you.</span>

<span class="sd">        `Example`</span>

<span class="sd">            #!python</span>
<span class="sd">            def reassigned_callback(args):</span>
<span class="sd">                print(args)</span>
<span class="sd">            ...</span>
<span class="sd">            client.register_callback_reassigned(reassigned_callback)</span>

<span class="sd">        This would print out something like the following on assignment of an R_ENTITY to</span>

<span class="sd">            #!python</span>
<span class="sd">            OrderedDict([(u&#39;lid&#39;, u&#39;moved_thing&#39;),</span>
<span class="sd">                         (u&#39;r&#39;, 1),</span>
<span class="sd">                         (u&#39;epId&#39;, u&#39;5a8d603ee757133d66d99875d0584c72&#39;),</span>
<span class="sd">                         (u&#39;id&#39;, u&#39;4448993b44738411de5fe2a6cf32d957&#39;)])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_reassigned</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__callback_subscribed_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_PAYLOAD</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="o">==</span> <span class="n">R_SUB</span><span class="p">:</span>
            <span class="bp">cls</span> <span class="o">=</span> <span class="n">RemoteFeed</span> <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_POINT_TYPE</span><span class="p">]</span> <span class="o">==</span> <span class="n">R_FEED</span> <span class="k">else</span> <span class="n">RemoteControl</span>
            <span class="n">callback</span><span class="p">(</span><span class="bp">cls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_ID</span><span class="p">],</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_POINT_ID</span><span class="p">],</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">register_callback_subscribed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a callback for new subscription. This gets called whenever one of *your* things subscribes to something</span>
<span class="sd">        else.</span>

<span class="sd">        `Note` it is not called when whenever something else subscribes to your thing.</span>

<span class="sd">        The payload passed to your callback is either a</span>
<span class="sd">        [RemoteControl](RemotePoint.m.html#IoticAgent.IOT.RemotePoint.RemoteControl) or</span>
<span class="sd">        [RemoteFeed](RemotePoint.m.html#IoticAgent.IOT.RemotePoint.RemoteFeed) instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_created</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_subscribed_filter</span><span class="p">,</span> <span class="n">callback</span><span class="p">),</span>
                                                       <span class="n">serialised</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">simulate_feeddata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feedid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Simulate the last feeddata received for given feedid</span>
<span class="sd">        Calls the registered callback for the feed with the last recieved feed data. Allows you to test your code</span>
<span class="sd">        without having to wait for the remote thing to share again.</span>

<span class="sd">        `feedid` (required) (string) local id of your Feed</span>

<span class="sd">        `data` (optional) (as applicable) The data you want to use to simulate the arrival of remote feed data</span>

<span class="sd">        `mime` (optional) (string) The mime type of your data. See also:</span>
<span class="sd">        [share()](./Point.m.html#IoticAgent.IOT.Point.Feed.share)</span>

<span class="sd">        `time` (optional) (datetime) UTC timestamp for share. See also:</span>
<span class="sd">        [share()](./Point.m.html#IoticAgent.IOT.Point.Feed.share)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">simulate_feeddata</span><span class="p">(</span><span class="n">feedid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># todo: simulate_controlreq -- needs last data and Point instance</span>
    <span class="c1">#</span>

    <span class="k">def</span> <span class="nf">confirm_tell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">success</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Confirm that you&#39;ve done as you were told.  Call this from your control callback to confirm action.</span>
<span class="sd">        Used when you are advertising a control and you want to tell the remote requestor that you have</span>
<span class="sd">        done what they asked you to.</span>

<span class="sd">        `Example:` this is a minimal example to show the idea.  Note - no Exception handling and ugly use of globals</span>

<span class="sd">            #!python</span>
<span class="sd">            client = None</span>

<span class="sd">            def controlreq_cb(args):</span>
<span class="sd">                global client   # the client object you connected with</span>

<span class="sd">                # perform your action with the data they sent</span>
<span class="sd">                success = do_control_action(args[&#39;data&#39;])</span>

<span class="sd">                if args[&#39;confirm&#39;]:  # you&#39;ve been asked to confirm</span>
<span class="sd">                    client.confirm_tell(args, success)</span>
<span class="sd">                # else, if you do not confirm_tell() this causes a timeout at the requestor&#39;s end.</span>

<span class="sd">            client = IOT.Client(config=&#39;test.ini&#39;)</span>
<span class="sd">            thing = client.create_thing(&#39;test321&#39;)</span>
<span class="sd">            control = thing.create_control(&#39;control&#39;, controlreq_cb)</span>

<span class="sd">        Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">        containing the error if the infrastructure detects a problem</span>

<span class="sd">        Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">        if there is a communications problem between you and the infrastructure</span>

<span class="sd">        `data` (mandatory) (dictionary)  The `&quot;args&quot;` dictionary that your callback was called with</span>

<span class="sd">        `success` (mandatory) (boolean)  Whether or not the action you have been asked to do has been</span>
<span class="sd">        sucessful.</span>

<span class="sd">        More details on the contents of the `data` dictionary for controls see:</span>
<span class="sd">        [create_control()](./Thing.m.html#IoticAgent.IOT.Thing.Thing.create_control)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;confirm_tell(success=</span><span class="si">%s</span><span class="s2">) [lid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">,pid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="n">success</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">P_LID</span><span class="p">])</span>
        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_point_confirm_tell</span><span class="p">(</span><span class="n">R_CONTROL</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">P_LID</span><span class="p">],</span> <span class="n">success</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;requestId&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the config, update the seqnum &amp; default language</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;seqnum&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">get_seqnum</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;lang&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">default_lang</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_parsed_feed_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="n">Validation</span><span class="o">.</span><span class="n">callable_check</span><span class="p">(</span><span class="n">callback_parsed</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parsed_callback_wrapper</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">R_FEED</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_parsed_control_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="n">Validation</span><span class="o">.</span><span class="n">callable_check</span><span class="p">(</span><span class="n">callback_parsed</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parsed_callback_wrapper</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">R_CONTROL</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_point_data_handler_for</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Used by point instances and data callbacks&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__point_data_handlers</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__point_data_handlers</span><span class="p">[</span><span class="n">point</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__point_data_handlers</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">PointDataObjectHandler</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_parsed_callback_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback_plain</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Used to by register_catchall_*data() and Thing class (follow, create_point) to present point data as an</span>
<span class="sd">        object.&quot;&quot;&quot;</span>
        <span class="c1"># used by PointDataObjectHandler as reference</span>
        <span class="k">if</span> <span class="n">foc</span> <span class="o">==</span> <span class="n">R_FEED</span><span class="p">:</span>
            <span class="n">point_ref</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pid&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># R_CONTROL</span>
            <span class="n">point_ref</span> <span class="o">=</span> <span class="n">Control</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">P_LID</span><span class="p">],</span> <span class="s1">&#39;0&#39;</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;parsed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_point_data_handler_for</span><span class="p">(</span><span class="n">point_ref</span><span class="p">)</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">P_DATA</span><span class="p">])</span>
        <span class="k">except</span> <span class="n">RefreshException</span><span class="p">:</span>
            <span class="c1"># No metadata available, do not produce warning</span>
            <span class="k">if</span> <span class="n">callback_plain</span><span class="p">:</span>
                <span class="n">callback_plain</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Failed to parse </span><span class="si">%s</span><span class="s1"> data for </span><span class="si">%s%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">foc_to_str</span><span class="p">(</span><span class="n">foc</span><span class="p">),</span> <span class="n">point_ref</span><span class="p">,</span>
                           <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">callback_plain</span> <span class="k">else</span> <span class="s1">&#39;, ignoring&#39;</span><span class="p">,</span>
                           <span class="n">exc_info</span><span class="o">=</span><span class="n">DEBUG_ENABLED</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">callback_plain</span><span class="p">:</span>
                <span class="n">callback_plain</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">callback_parsed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">__exception_mapping</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">E_FAILED_CODE_ACCESSDENIED</span><span class="p">:</span> <span class="n">IOTAccessDenied</span><span class="p">,</span>
        <span class="n">E_FAILED_CODE_INTERNALERROR</span><span class="p">:</span> <span class="n">IOTInternalError</span><span class="p">,</span>
        <span class="n">E_FAILED_CODE_MALFORMED</span><span class="p">:</span> <span class="n">IOTMalformed</span><span class="p">,</span>
        <span class="n">E_FAILED_CODE_NOTALLOWED</span><span class="p">:</span> <span class="n">IOTNotAllowed</span><span class="p">,</span>
        <span class="n">E_FAILED_CODE_UNKNOWN</span><span class="p">:</span> <span class="n">IOTUnknown</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_wait_and_except_if_failed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Combines waiting for event and call to `_except_if_failed`.&quot;&quot;&quot;</span>
        <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__sync_timeout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_except_if_failed</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_except_if_failed</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Raises an IOTException from the given event if it was not successful. Assumes timeout success flag on event</span>
<span class="sd">        has not been set yet.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">success</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">IOTSyncTimeout</span><span class="p">(</span><span class="s1">&#39;Requested timed out&#39;</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">event</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Request failed, unknown error&quot;</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">payload</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">P_MESSAGE</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">payload</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="n">P_MESSAGE</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">exc_class</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__exception_mapping</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="n">P_CODE</span><span class="p">]]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">exc_class</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>

            <span class="k">raise</span> <span class="n">IOTException</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_my_agents</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;List `all` the things created by this client on this or all your agents</span>

<span class="sd">        Returns QAPI list function payload</span>

<span class="sd">        Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">        if there is a communications problem between you and the infrastructure</span>

<span class="sd">        `all_my_agents` (optional) (boolean) If `False` limit search to just this agent,</span>
<span class="sd">        if `True` return list of things belonging to all agents you own.</span>

<span class="sd">        `limit` (optional) (integer) Return this many Point details</span>

<span class="sd">        `offset` (optional) (integer) Return Point details starting at this offset</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;list(all_my_agents=</span><span class="si">%s</span><span class="s2">, limit=</span><span class="si">%s</span><span class="s2">, offset=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">all_my_agents</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">all_my_agents</span><span class="p">:</span>
            <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_entity_list_all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_entity_list</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">evt</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;entities&#39;</span><span class="p">]</span>  <span class="c1"># pylint:disable=unsubscriptable-object</span>

    <span class="k">def</span> <span class="nf">get_thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the details of a newly created Thing. This only applies to asynchronous creation of Things and the</span>
<span class="sd">        new Thing instance can only be retrieved once.</span>

<span class="sd">        Returns a [Thing](Thing.m.html#IoticAgent.IOT.Thing.Thing) object,</span>
<span class="sd">        which corresponds to the Thing with the given local id (nickname)</span>

<span class="sd">        Raises `KeyError` if the Thing has not been newly created (or has already been retrieved by a previous call)</span>

<span class="sd">        `lid` (required) (string) local identifier of your Thing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                <span class="n">raise_from</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Thing </span><span class="si">%s</span><span class="s1"> not know as new&#39;</span> <span class="o">%</span> <span class="n">lid</span><span class="p">),</span> <span class="n">ex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new Thing with a local id (lid).</span>

<span class="sd">        Returns a [Thing](Thing.m.html#IoticAgent.IOT.Thing.Thing)  object if successful</span>
<span class="sd">        or if the Thing already exists</span>

<span class="sd">        Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">        containing the error if the infrastructure detects a problem</span>

<span class="sd">        Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">        if there is a communications problem between you and the infrastructure</span>

<span class="sd">        `lid` (required) (string) local identifier of your Thing.  The local id is your name or nickname for the thing.</span>
<span class="sd">        It&#39;s &quot;local&quot; in that it&#39;s only available to you on this container, not searchable and not visible to others.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_thing_async</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">raise_from</span><span class="p">(</span><span class="n">IOTClientError</span><span class="p">(</span><span class="s1">&#39;Thing </span><span class="si">%s</span><span class="s1"> not in cache (post-create)&#39;</span> <span class="o">%</span> <span class="n">lid</span><span class="p">),</span> <span class="n">ex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_thing_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;create_thing(lid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">lid</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_entity_create</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a Thing</span>

<span class="sd">        Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">        containing the error if the infrastructure detects a problem</span>

<span class="sd">        Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">        if there is a communications problem between you and the infrastructure</span>

<span class="sd">        `lid` (required) (string) local identifier of the Thing you want to delete</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;delete_thing(lid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">lid</span><span class="p">)</span>
        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_thing_async</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_thing_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;delete_thing(lid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">lid</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_entity_delete</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">reduced</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">scope</span><span class="o">=</span><span class="n">SearchScope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Search the Iotic Space for public Things with metadata matching the search parameters:</span>
<span class="sd">        text, lang(uage), location, unit, limit, offset. Note that only things which have at least one point defined can</span>
<span class="sd">        be found.</span>

<span class="sd">        Returns dict of results as below (first with reduced=False, second with reduced=True)- OR -</span>

<span class="sd">            #!python</span>
<span class="sd">            # reduced=False returns dict similar to below</span>
<span class="sd">            {</span>
<span class="sd">                &quot;2b2d8b068e404861b19f9e060877e002&quot;: {</span>
<span class="sd">                    &quot;long&quot;: -1.74803,</span>
<span class="sd">                    &quot;matches&quot;: 3.500,</span>
<span class="sd">                    &quot;lat&quot;: 52.4539,</span>
<span class="sd">                    &quot;label&quot;: &quot;Weather Station #2&quot;,</span>
<span class="sd">                    &quot;owner&quot;: &quot;3bbf307b43b1460289fe707619dece3d&quot;,</span>
<span class="sd">                    &quot;points&quot;: {</span>
<span class="sd">                        &quot;a300cc90147f4e2990195639de0af201&quot;: {</span>
<span class="sd">                            &quot;matches&quot;: 3.000,</span>
<span class="sd">                            &quot;label&quot;: &quot;Feed 201&quot;,</span>
<span class="sd">                            &quot;type&quot;: &quot;Feed&quot;,</span>
<span class="sd">                            &quot;storesRecent&quot;: true</span>
<span class="sd">                        },</span>
<span class="sd">                        &quot;a300cc90147f4e2990195639de0af202&quot;: {</span>
<span class="sd">                            &quot;matches&quot;: 1.500,</span>
<span class="sd">                            &quot;label&quot;: &quot;Feed 202&quot;,</span>
<span class="sd">                            &quot;type&quot;: &quot;Feed&quot;,</span>
<span class="sd">                            &quot;storesRecent&quot;: false</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                },</span>
<span class="sd">                &quot;76a3b24b02d34f20b675257624b0e001&quot;: {</span>
<span class="sd">                    &quot;long&quot;: 0.716356,</span>
<span class="sd">                    &quot;matches&quot;: 2.000,</span>
<span class="sd">                    &quot;lat&quot;: 52.244384,</span>
<span class="sd">                    &quot;label&quot;: &quot;Weather Station #1&quot;,</span>
<span class="sd">                    &quot;owner&quot;: &quot;3bbf307b43b1460289fe707619dece3d&quot;,</span>
<span class="sd">                    &quot;points&quot;: {</span>
<span class="sd">                        &quot;fb1a4a4dbb2642ab9f836892da93f101&quot;: {</span>
<span class="sd">                            &quot;matches&quot;: 1.000,</span>
<span class="sd">                            &quot;label&quot;: &quot;My weather feed&quot;,</span>
<span class="sd">                            &quot;type&quot;: &quot;Feed&quot;,</span>
<span class="sd">                            &quot;storesRecent&quot;: false</span>
<span class="sd">                        },</span>
<span class="sd">                        &quot;fb1a4a4dbb2642ab9f836892da93c102&quot;: {</span>
<span class="sd">                            &quot;matches&quot;: 1.000,</span>
<span class="sd">                            &quot;label&quot;: None,</span>
<span class="sd">                            &quot;type&quot;: &quot;Control&quot;,</span>
<span class="sd">                            &quot;storesRecent&quot;: false</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            }</span>

<span class="sd">            # reduced=True returns dict similar to below</span>
<span class="sd">            {</span>
<span class="sd">                &quot;2b2d8b068e404861b19f9e060877e002&quot;: {</span>
<span class="sd">                    &quot;a300cc90147f4e2990195639de0af201&quot;: &quot;Feed&quot;,</span>
<span class="sd">                    &quot;a300cc90147f4e2990195639de0af202&quot;: &quot;Feed&quot;</span>
<span class="sd">                },</span>
<span class="sd">                &quot;76a3b24b02d34f20b675257624b0e001&quot;: {</span>
<span class="sd">                    &quot;fb1a4a4dbb2642ab9f836892da93f101&quot;: &quot;Feed&quot;,</span>
<span class="sd">                    &quot;fb1a4a4dbb2642ab9f836892da93f102&quot;: &quot;Control&quot;</span>
<span class="sd">                }</span>
<span class="sd">            }</span>

<span class="sd">        Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">        containing the error if the infrastructure detects a problem</span>

<span class="sd">        Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">        if there is a communications problem between you and the infrastructure</span>

<span class="sd">        `text` (optional) (string) The text to search for. Label and description will be searched</span>
<span class="sd">        for both Thing and Point and each word will be used as a tag search too. Text search is case-insensitive. Tag</span>
<span class="sd">        search is language neutral.</span>

<span class="sd">        `lang` (optional) (string) The two-character ISO 639-1 language code to search in, e.g. &quot;en&quot; &quot;fr&quot;</span>
<span class="sd">        Language is used to limit search to only labels and descriptions in that language. You will only get labels `in</span>
<span class="sd">        that language` back from search and then only if there are any in that language.</span>

<span class="sd">        `location` (optional) (dictionary) Latitude, longitude and radius to search within.</span>
<span class="sd">        All values are float, Radius is in kilometers (km). E.g. `{&quot;lat&quot;=1.2345, &quot;long&quot;=54.321, &quot;radius&quot;=6.789}`. Note:</span>
<span class="sd">        If `text` has not been specified, radius can at most be 25km.</span>

<span class="sd">        `unit` (optional) (string) Valid URL of a unit in an ontology.  Or use a constant from the</span>
<span class="sd">        [units](../Units.m.html#IoticAgent.Units) class - such as [METRE](../Units.m.html#IoticAgent.Units.METRE).</span>

<span class="sd">        `limit` (optional) (integer) Return this many search results.</span>

<span class="sd">        `offset` (optional) (integer) Return results starting at this offset - good for paging.</span>

<span class="sd">        `reduced` (optional) (boolean) If `true`, return the reduced results just containing points and</span>
<span class="sd">        their type.</span>

<span class="sd">        `local` (optional) (boolean) **Deprecated**, use `scope` instead. If `true`, perform search at container level.</span>
<span class="sd">        Check the local_meta flag to determine whether local metadata functionality is available. (Takes precedence over</span>
<span class="sd">        `scope`.)</span>

<span class="sd">        `scope` (optional) ([SearchScope](../Core/Const.m.html#IoticAgent.Core.Const.SearchScope)) Whether to perform</span>
<span class="sd">        PUBLIC, LOCAL (container level) or LOCAL_OWN (container level restricted to own things) search. Check the</span>
<span class="sd">        [local_meta](#IoticAgent.IOT.Client.Client.local_meta) flag to determine whether local metadata functionality is</span>
<span class="sd">        available. (Note that PUBLIC and LOCAL_OWN scopes are always available.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;search(text=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, lang=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, location=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, unit=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, limit=</span><span class="si">%s</span><span class="s2">, offset=</span><span class="si">%s</span><span class="s2">, reduced=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">reduced</span><span class="p">)</span>
        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_search</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>
                                   <span class="n">SearchType</span><span class="o">.</span><span class="n">REDUCED</span> <span class="k">if</span> <span class="n">reduced</span> <span class="k">else</span> <span class="n">SearchType</span><span class="o">.</span><span class="n">FULL</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">evt</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>  <span class="c1"># pylint: disable=unsubscriptable-object</span>

    <span class="k">def</span> <span class="nf">search_reduced</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">scope</span><span class="o">=</span><span class="n">SearchScope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shorthand for [search()](#IoticAgent.IOT.Client.Client.search) with `reduced=True`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">reduced</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="n">scope</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">search_located</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">scope</span><span class="o">=</span><span class="n">SearchScope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See [search()](#IoticAgent.IOT.Client.Client.search) for general documentation. Provides a thing-only</span>
<span class="sd">        result set comprised only of things which have a location set, e.g.:</span>

<span class="sd">            #!python</span>
<span class="sd">            {</span>
<span class="sd">                # Keyed by thing id</span>
<span class="sd">                &#39;2b2d8b068e404861b19f9e060877e002&#39;:</span>
<span class="sd">                    # location (g, lat &amp; long), label (l, optional)</span>
<span class="sd">                    {&#39;g&#39;: (52.4539, -1.74803), &#39;l&#39;: &#39;Weather Station #2&#39;},</span>
<span class="sd">                &#39;76a3b24b02d34f20b675257624b0e001&#39;:</span>
<span class="sd">                    {&#39;g&#39;: (52.244384, 0.716356), &#39;l&#39;: None},</span>
<span class="sd">                &#39;76a3b24b02d34f20b675257624b0e004&#39;:</span>
<span class="sd">                    {&#39;g&#39;: (52.245384, 0.717356), &#39;l&#39;: &#39;Gasometer&#39;},</span>
<span class="sd">                &#39;76a3b24b02d34f20b675257624b0e005&#39;:</span>
<span class="sd">                    {&#39;g&#39;: (52.245384, 0.717356), &#39;l&#39;: &#39;Zepellin&#39;}</span>
<span class="sd">            }</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;search_located(text=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, lang=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, location=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, unit=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, limit=</span><span class="si">%s</span><span class="s2">, offset=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_search</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">SearchType</span><span class="o">.</span><span class="n">LOCATED</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">evt</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>  <span class="c1"># pylint: disable=unsubscriptable-object</span>

    <span class="c1"># used by describe()</span>
    <span class="n">__guid_resources</span> <span class="o">=</span> <span class="p">(</span><span class="n">Thing</span><span class="p">,</span> <span class="n">Point</span><span class="p">,</span> <span class="n">RemoteFeed</span><span class="p">,</span> <span class="n">RemoteControl</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guid_or_resource</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="n">DescribeScope</span><span class="o">.</span><span class="n">AUTO</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Describe returns the public (or local) description of a Thing or Point</span>

<span class="sd">        Returns the description dict (see below for Thing example) if available, otherwise `None`</span>

<span class="sd">            #!python</span>
<span class="sd">            {</span>
<span class="sd">                &quot;type&quot;: &quot;Entity&quot;,</span>
<span class="sd">                &quot;meta&quot;: {</span>
<span class="sd">                    &quot;long&quot;: 0.716356,</span>
<span class="sd">                    &quot;lat&quot;: 52.244384,</span>
<span class="sd">                    &quot;label&quot;: &quot;Weather Station #1&quot;,</span>
<span class="sd">                    &quot;parent&quot;: &quot;3bbf307b43b1460289fe707619dece3d&quot;,</span>
<span class="sd">                    &quot;points&quot;: [</span>
<span class="sd">                        {</span>
<span class="sd">                            &quot;type&quot;: &quot;Control&quot;,</span>
<span class="sd">                            &quot;label&quot;: &quot;Control 101&quot;,</span>
<span class="sd">                            &quot;guid&quot;: &quot;fb1a4a4dbb2642ab9f836892da93c101&quot;,</span>
<span class="sd">                            &quot;storesRecent&quot;: false</span>
<span class="sd">                        },</span>
<span class="sd">                        {</span>
<span class="sd">                            &quot;type&quot;: &quot;Feed&quot;,</span>
<span class="sd">                            &quot;label&quot;: &quot;My weather feed&quot;,</span>
<span class="sd">                            &quot;guid&quot;: &quot;fb1a4a4dbb2642ab9f836892da93f101&quot;,</span>
<span class="sd">                            &quot;storesRecent&quot;: true</span>
<span class="sd">                        }</span>
<span class="sd">                    ],</span>
<span class="sd">                    &quot;comment&quot;: &quot;A lovely weather station...&quot;,</span>
<span class="sd">                    &quot;tags&quot;: [</span>
<span class="sd">                        &quot;blue&quot;,</span>
<span class="sd">                        &quot;garden&quot;</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            }</span>

<span class="sd">        Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">        containing the error if the infrastructure detects a problem</span>

<span class="sd">        Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">        if there is a communications problem between you and the infrastructure</span>

<span class="sd">        `guid_or_resource` (mandatory) (string or object).</span>
<span class="sd">        If a `string`, it should contain the globally unique id of the resource you want to describe in 8-4-4-4-12</span>
<span class="sd">        (or undashed) format.</span>
<span class="sd">        If an `object`, it should be an instance of Thing, Point, RemoteFeed or RemoteControl.  The system will return</span>
<span class="sd">        you the description of that object.</span>

<span class="sd">        `lang` (optional) (string) The two-character ISO 639-1 language code for which labels and comments will be</span>
<span class="sd">        returned. This does not affect Values (i.e. when describing a Point, apart from value comments) and tags as</span>
<span class="sd">        these are language neutral).</span>

<span class="sd">        `local` (optional) (boolean) **Deprecated**, use `scope` instead. If `true`, lookup metadata at container level.</span>
<span class="sd">        Check the local_meta flag to determine whether local metadata functionality is available. (Takes precedence over</span>
<span class="sd">        `scope`.)</span>

<span class="sd">        `scope` (optional) ([DescribeScope](../Core/Const.m.html#IoticAgent.Core.Const.DescribeScope)) Whether to</span>
<span class="sd">        perform PUBLIC, LOCAL (container level) or LOCAL_OWN (container level restricted to own things) metadata lookup.</span>
<span class="sd">        Check the [local_meta](#IoticAgent.IOT.Client.Client.local_meta) flag to determine whether local metadata</span>
<span class="sd">        functionality is available. (Note that AUTO, PUBLIC and LOCAL_OWN scopes are always available.). AUTO mode</span>
<span class="sd">        first attempts to look up private metadata, then public.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">guid_or_resource</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__guid_resources</span><span class="p">):</span>
            <span class="n">guid</span> <span class="o">=</span> <span class="n">guid_or_resource</span><span class="o">.</span><span class="n">guid</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">guid_or_resource</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
            <span class="n">guid</span> <span class="o">=</span> <span class="n">uuid_to_hex</span><span class="p">(</span><span class="n">guid_or_resource</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;describe requires guid string or Thing, Point, RemoteFeed or RemoteControl instance&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;describe() [guid=&quot;</span><span class="si">%s</span><span class="s1">&quot;]&#39;</span><span class="p">,</span> <span class="n">guid</span><span class="p">)</span>

        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_describe</span><span class="p">(</span><span class="n">guid</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">evt</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>  <span class="c1"># pylint: disable=unsubscriptable-object</span>

    <span class="k">def</span> <span class="nf">__cb_created</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">duplicated</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="c1"># Only consider solicitied creation events since there is no cache. This also applies to things reassigned to</span>
        <span class="c1"># this agent.</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_PAYLOAD</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_CLIENTREF</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="o">==</span> <span class="n">R_ENTITY</span><span class="p">:</span>
                <span class="n">lid</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_LID</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_EPID</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">epId</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Created thing </span><span class="si">%s</span><span class="s1"> assigned to different agent: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_EPID</span><span class="p">])</span>
                <span class="n">thing</span> <span class="o">=</span> <span class="n">Thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_ID</span><span class="p">],</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_EPID</span><span class="p">])</span>

                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">[</span><span class="n">lid</span><span class="p">]</span> <span class="o">=</span> <span class="n">thing</span>
                <span class="c1"># second (permanent) reference kept so can forward to thing for e.g. point creation callbacks</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">[</span><span class="n">lid</span><span class="p">]</span> <span class="o">=</span> <span class="n">thing</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Added </span><span class="si">%s</span><span class="s1">thing: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="s1">&#39;existing &#39;</span> <span class="k">if</span> <span class="n">duplicated</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_ID</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="ow">in</span> <span class="n">_POINT_TYPES</span> <span class="ow">or</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="o">==</span> <span class="n">R_SUB</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">:</span>
                    <span class="n">thing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">],</span> <span class="bp">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">thing</span><span class="p">:</span>
                    <span class="n">thing</span><span class="o">.</span><span class="n">_cb_created</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">duplicated</span><span class="o">=</span><span class="n">duplicated</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Thing </span><span class="si">%s</span><span class="s1"> unknown internally, ignoring creation of point/sub&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Resource creation of type </span><span class="si">%d</span><span class="s1"> unhandled&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Ignoring unsolicited creation request of type </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__cb_duplicated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__cb_created</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">duplicated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__cb_reassigned</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_PAYLOAD</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="o">==</span> <span class="n">R_ENTITY</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">:</span>
                <span class="n">thing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="n">P_LID</span><span class="p">],</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">thing</span><span class="p">:</span>
                <span class="n">thing</span><span class="o">.</span><span class="n">_cb_reassigned</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Thing </span><span class="si">%s</span><span class="s1"> unknown internally, ignoring reassignment&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_LID</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Resource reassignment of type </span><span class="si">%d</span><span class="s1"> unhandled&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__cb_deleted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="c1"># only consider solicitied deletion events</span>
        <span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_CLIENTREF</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_PAYLOAD</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="o">==</span> <span class="n">R_ENTITY</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="n">P_LID</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Deleted thing </span><span class="si">%s</span><span class="s1"> unknown internally&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_LID</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Deleted thing: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_LID</span><span class="p">])</span>

            <span class="c1"># currently no functionality benefits from these</span>
            <span class="k">elif</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="n">R_FEED</span><span class="p">,</span> <span class="n">R_CONTROL</span><span class="p">,</span> <span class="n">R_SUB</span><span class="p">):</span>
                <span class="k">pass</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Resource deletetion of type </span><span class="si">%d</span><span class="s1"> unhandled&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="n">P_RESOURCE</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Ignoring unsolicited deletion request of type </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">msg</span><span class="p">[</span><span class="n">M_PAYLOAD</span><span class="p">][</span><span class="n">P_RESOURCE</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__cb_recent_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># determine specific callback</span>
                <span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">M_CLIENTREF</span><span class="p">]]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;No callback for recent data request with id </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">M_CLIENTREF</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">callback</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Recent data callback failed for point </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">P_POINT_ID</span><span class="p">],</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">DEBUG_ENABLED</span><span class="p">)</span>

    <span class="c1"># Registrer specific callback function (for a recent data callback) which will be removed on request completion. The</span>
    <span class="c1"># request is NOT checked first.</span>
    <span class="k">def</span> <span class="nf">_add_recent_cb_for</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span><span class="p">[</span><span class="n">req</span><span class="o">.</span><span class="n">id_</span><span class="p">]</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__recent_cb_per_sample</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
        <span class="n">req</span><span class="o">.</span><span class="n">_run_on_completion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__remove_recent_cb_for</span><span class="p">)</span>

    <span class="c1"># multi-sample to per-sample callback wrapper</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__recent_cb_per_sample</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;samples&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
            <span class="n">func</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

    <span class="c1"># used by _add_recent_cb_for only</span>
    <span class="k">def</span> <span class="nf">__remove_recent_cb_for</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">id_</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;recent cb does not exist for request </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">req</span><span class="o">.</span><span class="n">id_</span><span class="p">)</span>

    <span class="c1"># Wrap Core.Client functions so IOT contains everything.</span>
    <span class="c1"># These are protected functions used by Client, Thing, Point etc.</span>
    <span class="k">def</span> <span class="nf">_request_point_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_list</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_list_detailed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_list_detailed</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_recent_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_recent_info</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_recent_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_recent_config</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">max_samples</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_list</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_list_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_list_all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_create</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">new_lid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_rename</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">new_lid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_delete</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_reassign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">new_epid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_reassign</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">new_epid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_meta_setpublic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">public</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_meta_setpublic</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">public</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_tag_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_tag_update</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">delete</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_tag_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_tag_list</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_meta_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_meta_get</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_entity_meta_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">rdf</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_entity_meta_set</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">rdf</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">control_cb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">save_recent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_create</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">control_cb</span><span class="p">,</span> <span class="n">save_recent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">newpid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_rename</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">newpid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_delete</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_share</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_share</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_confirm_tell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">success</span><span class="p">,</span> <span class="n">requestId</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_confirm_tell</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">success</span><span class="p">,</span> <span class="n">requestId</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_meta_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_meta_get</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_meta_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">rdf</span><span class="p">,</span> <span class="n">fmt</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_meta_set</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">rdf</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_tag_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_tag_update</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">delete</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_tag_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_tag_list</span><span class="p">(</span><span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_value_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">vtype</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_value_create</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">vtype</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_value_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_value_delete</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_point_value_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_point_value_list</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_create_local</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_create_local</span><span class="p">(</span><span class="n">slid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">gpid</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_create</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">foc</span><span class="p">,</span> <span class="n">gpid</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_ask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_ask</span><span class="p">(</span><span class="n">subid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_tell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">mime</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_tell</span><span class="p">(</span><span class="n">subid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">mime</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subid</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_delete</span><span class="p">(</span><span class="n">subid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_list</span><span class="p">(</span><span class="n">lid</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_sub_recent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_id</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_sub_recent</span><span class="p">(</span><span class="n">sub_id</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">scope</span><span class="o">=</span><span class="n">SearchScope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_search</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_request_describe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guid</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="n">DescribeScope</span><span class="o">.</span><span class="n">AUTO</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">request_describe</span><span class="p">(</span><span class="n">guid</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#IoticAgent.IOT.Client.Client">Client</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, config=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates an IOT.Client instance which provides access to Iotic Space</p>
<p><code>config</code> (optional): The name of the config file containing the connection parameters.
Defaults to the name of the script +".ini", e.g. <code>config="my_script.ini"</code>. Alternatively
an existing <a href="Config.m.html#IoticAgent.IOT.Config.Config">Config</a> object can be specified.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.__init__', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates an IOT.Client instance which provides access to Iotic Space</span>
<span class="sd">    `config` (optional): The name of the config file containing the connection parameters.</span>
<span class="sd">    Defaults to the name of the script +&quot;.ini&quot;, e.g. `config=&quot;my_script.ini&quot;`. Alternatively</span>
<span class="sd">    an existing [Config](Config.m.html#IoticAgent.IOT.Config.Config) object can be specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__core_version_check</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;IOT version: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">__version__</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">string_types</span><span class="p">)</span> <span class="ow">or</span> <span class="n">config</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">Config</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__config</span> <span class="o">=</span> <span class="n">config</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;config should be string or Config instance&#39;</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">,</span> <span class="s1">&#39;epid&#39;</span><span class="p">,</span> <span class="s1">&#39;passwd&#39;</span><span class="p">,</span> <span class="s1">&#39;token&#39;</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Minimum configuration for IoticAgent is host, epid, passwd and token</span><span class="se">\n</span><span class="s1">&#39;</span>
                         <span class="s1">&#39;Create file &quot;</span><span class="si">%s</span><span class="s1">&quot; with contents</span><span class="se">\n</span><span class="s1">[agent]</span><span class="se">\n</span><span class="s1">host = w</span><span class="se">\n</span><span class="s1">epid = x</span><span class="se">\n</span><span class="s1">passwd = y</span><span class="se">\n</span><span class="s1">token = z&#39;</span>
                         <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">_file_loc</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__sync_timeout</span> <span class="o">=</span> <span class="n">validate_nonnegative_int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;iot&#39;</span><span class="p">,</span> <span class="s1">&#39;sync_request_timeout&#39;</span><span class="p">),</span>
                                                   <span class="s1">&#39;iot.sync_request_timeout&#39;</span><span class="p">,</span> <span class="n">allow_zero</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">setup_logging</span><span class="p">()</span>
    <span class="c1">#</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span> <span class="o">=</span> <span class="n">Core_Client</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;host&#39;</span><span class="p">),</span>
                                    <span class="n">vhost</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;vhost&#39;</span><span class="p">),</span>
                                    <span class="n">epId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;epid&#39;</span><span class="p">),</span>
                                    <span class="n">lang</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;lang&#39;</span><span class="p">),</span>
                                    <span class="n">passwd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;passwd&#39;</span><span class="p">),</span>
                                    <span class="n">token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;token&#39;</span><span class="p">),</span>
                                    <span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;prefix&#39;</span><span class="p">),</span>
                                    <span class="n">sslca</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;sslca&#39;</span><span class="p">),</span>
                                    <span class="n">network_retry_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;network_retry_timeout&#39;</span><span class="p">),</span>
                                    <span class="n">socket_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;socket_timeout&#39;</span><span class="p">),</span>
                                    <span class="n">auto_encode_decode</span><span class="o">=</span><span class="n">bool_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;auto_encode_decode&#39;</span><span class="p">),</span>
                                                                 <span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
                                    <span class="n">send_queue_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;queue_size&#39;</span><span class="p">),</span>
                                    <span class="n">throttle_conf</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;throttle&#39;</span><span class="p">),</span>
                                    <span class="n">max_encoded_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;max_encoded_length&#39;</span><span class="p">),</span>
                                    <span class="n">startup_ignore_exc</span><span class="o">=</span><span class="n">bool_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="s1">&#39;startup_ignore_exc&#39;</span><span class="p">),</span>
                                                                 <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="n">raise_from</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Configuration error&#39;</span><span class="p">),</span> <span class="n">ex</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Callbacks for updating own resource cache (used internally only)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_created</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_created</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_duplicate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_duplicated</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_reassigned</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_reassigned</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_deleted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_deleted</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_recent_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cb_recent_data</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Keeps track of newly created things (the requests for which originated from this agent)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span> <span class="o">=</span> <span class="n">ThreadSafeDict</span><span class="p">()</span>
    <span class="c1"># Allows client to forward e.g. Point creation callbacks to the relevant Thing instance. This contains the most</span>
    <span class="c1"># recent instance of any single Thing (since creation requests can be performed more than once).</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__private_things</span> <span class="o">=</span> <span class="n">ThreadSafeDict</span><span class="p">()</span>
    <span class="c1"># PointDataObjectHandler cache</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__point_data_handlers</span> <span class="o">=</span> <span class="n">ThreadSafeDict</span><span class="p">()</span>
    <span class="c1"># recent data callbacks by request id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__recent_data_callbacks</span> <span class="o">=</span> <span class="n">ThreadSafeDict</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.confirm_tell">
    <p>def <span class="ident">confirm_tell</span>(</p><p>self, data, success)</p>
    </div>
    

    
  
    <div class="desc"><p>Confirm that you've done as you were told.  Call this from your control callback to confirm action.
Used when you are advertising a control and you want to tell the remote requestor that you have
done what they asked you to.</p>
<p><code>Example:</code> this is a minimal example to show the idea.  Note - no Exception handling and ugly use of globals</p>
<div class="codehilite"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">controlreq_cb</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">client</span>   <span class="c1"># the client object you connected with</span>

    <span class="c1"># perform your action with the data they sent</span>
    <span class="n">success</span> <span class="o">=</span> <span class="n">do_control_action</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;confirm&#39;</span><span class="p">]:</span>  <span class="c1"># you&#39;ve been asked to confirm</span>
        <span class="n">client</span><span class="o">.</span><span class="n">confirm_tell</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">success</span><span class="p">)</span>
    <span class="c1"># else, if you do not confirm_tell() this causes a timeout at the requestor&#39;s end.</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">IOT</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;test.ini&#39;</span><span class="p">)</span>
<span class="n">thing</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_thing</span><span class="p">(</span><span class="s1">&#39;test321&#39;</span><span class="p">)</span>
<span class="n">control</span> <span class="o">=</span> <span class="n">thing</span><span class="o">.</span><span class="n">create_control</span><span class="p">(</span><span class="s1">&#39;control&#39;</span><span class="p">,</span> <span class="n">controlreq_cb</span><span class="p">)</span>
</pre></div>


<p>Raises <a href="./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException">IOTException</a>
containing the error if the infrastructure detects a problem</p>
<p>Raises <a href="../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException">LinkException</a>
if there is a communications problem between you and the infrastructure</p>
<p><code>data</code> (mandatory) (dictionary)  The <code>"args"</code> dictionary that your callback was called with</p>
<p><code>success</code> (mandatory) (boolean)  Whether or not the action you have been asked to do has been
sucessful.</p>
<p>More details on the contents of the <code>data</code> dictionary for controls see:
<a href="./Thing.m.html#IoticAgent.IOT.Thing.Thing.create_control">create_control()</a></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.confirm_tell', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.confirm_tell" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">confirm_tell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">success</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Confirm that you&#39;ve done as you were told.  Call this from your control callback to confirm action.</span>
<span class="sd">    Used when you are advertising a control and you want to tell the remote requestor that you have</span>
<span class="sd">    done what they asked you to.</span>
<span class="sd">    `Example:` this is a minimal example to show the idea.  Note - no Exception handling and ugly use of globals</span>
<span class="sd">        #!python</span>
<span class="sd">        client = None</span>
<span class="sd">        def controlreq_cb(args):</span>
<span class="sd">            global client   # the client object you connected with</span>
<span class="sd">            # perform your action with the data they sent</span>
<span class="sd">            success = do_control_action(args[&#39;data&#39;])</span>
<span class="sd">            if args[&#39;confirm&#39;]:  # you&#39;ve been asked to confirm</span>
<span class="sd">                client.confirm_tell(args, success)</span>
<span class="sd">            # else, if you do not confirm_tell() this causes a timeout at the requestor&#39;s end.</span>
<span class="sd">        client = IOT.Client(config=&#39;test.ini&#39;)</span>
<span class="sd">        thing = client.create_thing(&#39;test321&#39;)</span>
<span class="sd">        control = thing.create_control(&#39;control&#39;, controlreq_cb)</span>
<span class="sd">    Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">    containing the error if the infrastructure detects a problem</span>
<span class="sd">    Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">    if there is a communications problem between you and the infrastructure</span>
<span class="sd">    `data` (mandatory) (dictionary)  The `&quot;args&quot;` dictionary that your callback was called with</span>
<span class="sd">    `success` (mandatory) (boolean)  Whether or not the action you have been asked to do has been</span>
<span class="sd">    sucessful.</span>
<span class="sd">    More details on the contents of the `data` dictionary for controls see:</span>
<span class="sd">    [create_control()](./Thing.m.html#IoticAgent.IOT.Thing.Thing.create_control)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;confirm_tell(success=</span><span class="si">%s</span><span class="s2">) [lid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">,pid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="n">success</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">P_LID</span><span class="p">])</span>
    <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_point_confirm_tell</span><span class="p">(</span><span class="n">R_CONTROL</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">P_ENTITY_LID</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">P_LID</span><span class="p">],</span> <span class="n">success</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;requestId&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.create_thing">
    <p>def <span class="ident">create_thing</span>(</p><p>self, lid)</p>
    </div>
    

    
  
    <div class="desc"><p>Create a new Thing with a local id (lid).</p>
<p>Returns a <a href="Thing.m.html#IoticAgent.IOT.Thing.Thing">Thing</a>  object if successful
or if the Thing already exists</p>
<p>Raises <a href="./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException">IOTException</a>
containing the error if the infrastructure detects a problem</p>
<p>Raises <a href="../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException">LinkException</a>
if there is a communications problem between you and the infrastructure</p>
<p><code>lid</code> (required) (string) local identifier of your Thing.  The local id is your name or nickname for the thing.
It's "local" in that it's only available to you on this container, not searchable and not visible to others.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.create_thing', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.create_thing" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a new Thing with a local id (lid).</span>
<span class="sd">    Returns a [Thing](Thing.m.html#IoticAgent.IOT.Thing.Thing)  object if successful</span>
<span class="sd">    or if the Thing already exists</span>
<span class="sd">    Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">    containing the error if the infrastructure detects a problem</span>
<span class="sd">    Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">    if there is a communications problem between you and the infrastructure</span>
<span class="sd">    `lid` (required) (string) local identifier of your Thing.  The local id is your name or nickname for the thing.</span>
<span class="sd">    It&#39;s &quot;local&quot; in that it&#39;s only available to you on this container, not searchable and not visible to others.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_thing_async</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">raise_from</span><span class="p">(</span><span class="n">IOTClientError</span><span class="p">(</span><span class="s1">&#39;Thing </span><span class="si">%s</span><span class="s1"> not in cache (post-create)&#39;</span> <span class="o">%</span> <span class="n">lid</span><span class="p">),</span> <span class="n">ex</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.create_thing_async">
    <p>def <span class="ident">create_thing_async</span>(</p><p>self, lid)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.create_thing_async', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.create_thing_async" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_thing_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;create_thing(lid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">lid</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_entity_create</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.delete_thing">
    <p>def <span class="ident">delete_thing</span>(</p><p>self, lid)</p>
    </div>
    

    
  
    <div class="desc"><p>Delete a Thing</p>
<p>Raises <a href="./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException">IOTException</a>
containing the error if the infrastructure detects a problem</p>
<p>Raises <a href="../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException">LinkException</a>
if there is a communications problem between you and the infrastructure</p>
<p><code>lid</code> (required) (string) local identifier of the Thing you want to delete</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.delete_thing', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.delete_thing" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete a Thing</span>
<span class="sd">    Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">    containing the error if the infrastructure detects a problem</span>
<span class="sd">    Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">    if there is a communications problem between you and the infrastructure</span>
<span class="sd">    `lid` (required) (string) local identifier of the Thing you want to delete</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;delete_thing(lid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">lid</span><span class="p">)</span>
    <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_thing_async</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.delete_thing_async">
    <p>def <span class="ident">delete_thing_async</span>(</p><p>self, lid)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.delete_thing_async', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.delete_thing_async" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_thing_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;delete_thing(lid=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">lid</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_entity_delete</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.describe">
    <p>def <span class="ident">describe</span>(</p><p>self, guid_or_resource, lang=None, local=None, scope=&lt;DescribeScope.AUTO: &#39;auto&#39;&gt;)</p>
    </div>
    

    
  
    <div class="desc"><p>Describe returns the public (or local) description of a Thing or Point</p>
<p>Returns the description dict (see below for Thing example) if available, otherwise <code>None</code></p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Entity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="mf">0.716356</span><span class="p">,</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mf">52.244384</span><span class="p">,</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Weather Station #1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;3bbf307b43b1460289fe707619dece3d&quot;</span><span class="p">,</span>
        <span class="s2">&quot;points&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Control&quot;</span><span class="p">,</span>
                <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Control 101&quot;</span><span class="p">,</span>
                <span class="s2">&quot;guid&quot;</span><span class="p">:</span> <span class="s2">&quot;fb1a4a4dbb2642ab9f836892da93c101&quot;</span><span class="p">,</span>
                <span class="s2">&quot;storesRecent&quot;</span><span class="p">:</span> <span class="n">false</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feed&quot;</span><span class="p">,</span>
                <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;My weather feed&quot;</span><span class="p">,</span>
                <span class="s2">&quot;guid&quot;</span><span class="p">:</span> <span class="s2">&quot;fb1a4a4dbb2642ab9f836892da93f101&quot;</span><span class="p">,</span>
                <span class="s2">&quot;storesRecent&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;A lovely weather station...&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;blue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;garden&quot;</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Raises <a href="./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException">IOTException</a>
containing the error if the infrastructure detects a problem</p>
<p>Raises <a href="../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException">LinkException</a>
if there is a communications problem between you and the infrastructure</p>
<p><code>guid_or_resource</code> (mandatory) (string or object).
If a <code>string</code>, it should contain the globally unique id of the resource you want to describe in 8-4-4-4-12
(or undashed) format.
If an <code>object</code>, it should be an instance of Thing, Point, RemoteFeed or RemoteControl.  The system will return
you the description of that object.</p>
<p><code>lang</code> (optional) (string) The two-character ISO 639-1 language code for which labels and comments will be
returned. This does not affect Values (i.e. when describing a Point, apart from value comments) and tags as
these are language neutral).</p>
<p><code>local</code> (optional) (boolean) <strong>Deprecated</strong>, use <code>scope</code> instead. If <code>true</code>, lookup metadata at container level.
Check the local_meta flag to determine whether local metadata functionality is available. (Takes precedence over
<code>scope</code>.)</p>
<p><code>scope</code> (optional) (<a href="../Core/Const.m.html#IoticAgent.Core.Const.DescribeScope">DescribeScope</a>) Whether to
perform PUBLIC, LOCAL (container level) or LOCAL_OWN (container level restricted to own things) metadata lookup.
Check the <a href="#IoticAgent.IOT.Client.Client.local_meta">local_meta</a> flag to determine whether local metadata
functionality is available. (Note that AUTO, PUBLIC and LOCAL_OWN scopes are always available.). AUTO mode
first attempts to look up private metadata, then public.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.describe', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.describe" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guid_or_resource</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="n">DescribeScope</span><span class="o">.</span><span class="n">AUTO</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Describe returns the public (or local) description of a Thing or Point</span>
<span class="sd">    Returns the description dict (see below for Thing example) if available, otherwise `None`</span>
<span class="sd">        #!python</span>
<span class="sd">        {</span>
<span class="sd">            &quot;type&quot;: &quot;Entity&quot;,</span>
<span class="sd">            &quot;meta&quot;: {</span>
<span class="sd">                &quot;long&quot;: 0.716356,</span>
<span class="sd">                &quot;lat&quot;: 52.244384,</span>
<span class="sd">                &quot;label&quot;: &quot;Weather Station #1&quot;,</span>
<span class="sd">                &quot;parent&quot;: &quot;3bbf307b43b1460289fe707619dece3d&quot;,</span>
<span class="sd">                &quot;points&quot;: [</span>
<span class="sd">                    {</span>
<span class="sd">                        &quot;type&quot;: &quot;Control&quot;,</span>
<span class="sd">                        &quot;label&quot;: &quot;Control 101&quot;,</span>
<span class="sd">                        &quot;guid&quot;: &quot;fb1a4a4dbb2642ab9f836892da93c101&quot;,</span>
<span class="sd">                        &quot;storesRecent&quot;: false</span>
<span class="sd">                    },</span>
<span class="sd">                    {</span>
<span class="sd">                        &quot;type&quot;: &quot;Feed&quot;,</span>
<span class="sd">                        &quot;label&quot;: &quot;My weather feed&quot;,</span>
<span class="sd">                        &quot;guid&quot;: &quot;fb1a4a4dbb2642ab9f836892da93f101&quot;,</span>
<span class="sd">                        &quot;storesRecent&quot;: true</span>
<span class="sd">                    }</span>
<span class="sd">                ],</span>
<span class="sd">                &quot;comment&quot;: &quot;A lovely weather station...&quot;,</span>
<span class="sd">                &quot;tags&quot;: [</span>
<span class="sd">                    &quot;blue&quot;,</span>
<span class="sd">                    &quot;garden&quot;</span>
<span class="sd">                ]</span>
<span class="sd">            }</span>
<span class="sd">        }</span>
<span class="sd">    Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">    containing the error if the infrastructure detects a problem</span>
<span class="sd">    Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">    if there is a communications problem between you and the infrastructure</span>
<span class="sd">    `guid_or_resource` (mandatory) (string or object).</span>
<span class="sd">    If a `string`, it should contain the globally unique id of the resource you want to describe in 8-4-4-4-12</span>
<span class="sd">    (or undashed) format.</span>
<span class="sd">    If an `object`, it should be an instance of Thing, Point, RemoteFeed or RemoteControl.  The system will return</span>
<span class="sd">    you the description of that object.</span>
<span class="sd">    `lang` (optional) (string) The two-character ISO 639-1 language code for which labels and comments will be</span>
<span class="sd">    returned. This does not affect Values (i.e. when describing a Point, apart from value comments) and tags as</span>
<span class="sd">    these are language neutral).</span>
<span class="sd">    `local` (optional) (boolean) **Deprecated**, use `scope` instead. If `true`, lookup metadata at container level.</span>
<span class="sd">    Check the local_meta flag to determine whether local metadata functionality is available. (Takes precedence over</span>
<span class="sd">    `scope`.)</span>
<span class="sd">    `scope` (optional) ([DescribeScope](../Core/Const.m.html#IoticAgent.Core.Const.DescribeScope)) Whether to</span>
<span class="sd">    perform PUBLIC, LOCAL (container level) or LOCAL_OWN (container level restricted to own things) metadata lookup.</span>
<span class="sd">    Check the [local_meta](#IoticAgent.IOT.Client.Client.local_meta) flag to determine whether local metadata</span>
<span class="sd">    functionality is available. (Note that AUTO, PUBLIC and LOCAL_OWN scopes are always available.). AUTO mode</span>
<span class="sd">    first attempts to look up private metadata, then public.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">guid_or_resource</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__guid_resources</span><span class="p">):</span>
        <span class="n">guid</span> <span class="o">=</span> <span class="n">guid_or_resource</span><span class="o">.</span><span class="n">guid</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">guid_or_resource</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
        <span class="n">guid</span> <span class="o">=</span> <span class="n">uuid_to_hex</span><span class="p">(</span><span class="n">guid_or_resource</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;describe requires guid string or Thing, Point, RemoteFeed or RemoteControl instance&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;describe() [guid=&quot;</span><span class="si">%s</span><span class="s1">&quot;]&#39;</span><span class="p">,</span> <span class="n">guid</span><span class="p">)</span>
    <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_describe</span><span class="p">(</span><span class="n">guid</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">evt</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>  <span class="c1"># pylint: disable=unsubscriptable-object</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.get_thing">
    <p>def <span class="ident">get_thing</span>(</p><p>self, lid)</p>
    </div>
    

    
  
    <div class="desc"><p>Get the details of a newly created Thing. This only applies to asynchronous creation of Things and the
new Thing instance can only be retrieved once.</p>
<p>Returns a <a href="Thing.m.html#IoticAgent.IOT.Thing.Thing">Thing</a> object,
which corresponds to the Thing with the given local id (nickname)</p>
<p>Raises <code>KeyError</code> if the Thing has not been newly created (or has already been retrieved by a previous call)</p>
<p><code>lid</code> (required) (string) local identifier of your Thing.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.get_thing', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.get_thing" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the details of a newly created Thing. This only applies to asynchronous creation of Things and the</span>
<span class="sd">    new Thing instance can only be retrieved once.</span>
<span class="sd">    Returns a [Thing](Thing.m.html#IoticAgent.IOT.Thing.Thing) object,</span>
<span class="sd">    which corresponds to the Thing with the given local id (nickname)</span>
<span class="sd">    Raises `KeyError` if the Thing has not been newly created (or has already been retrieved by a previous call)</span>
<span class="sd">    `lid` (required) (string) local identifier of your Thing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new_things</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">lid</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">raise_from</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Thing </span><span class="si">%s</span><span class="s1"> not know as new&#39;</span> <span class="o">%</span> <span class="n">lid</span><span class="p">),</span> <span class="n">ex</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.is_connected">
    <p>def <span class="ident">is_connected</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns client's alive state</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.is_connected', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.is_connected" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns client&#39;s alive state</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.list">
    <p>def <span class="ident">list</span>(</p><p>self, all_my_agents=False, limit=500, offset=0)</p>
    </div>
    

    
  
    <div class="desc"><p>List <code>all</code> the things created by this client on this or all your agents</p>
<p>Returns QAPI list function payload</p>
<p>Raises <a href="../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException">LinkException</a>
if there is a communications problem between you and the infrastructure</p>
<p><code>all_my_agents</code> (optional) (boolean) If <code>False</code> limit search to just this agent,
if <code>True</code> return list of things belonging to all agents you own.</p>
<p><code>limit</code> (optional) (integer) Return this many Point details</p>
<p><code>offset</code> (optional) (integer) Return Point details starting at this offset</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.list', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_my_agents</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;List `all` the things created by this client on this or all your agents</span>
<span class="sd">    Returns QAPI list function payload</span>
<span class="sd">    Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">    if there is a communications problem between you and the infrastructure</span>
<span class="sd">    `all_my_agents` (optional) (boolean) If `False` limit search to just this agent,</span>
<span class="sd">    if `True` return list of things belonging to all agents you own.</span>
<span class="sd">    `limit` (optional) (integer) Return this many Point details</span>
<span class="sd">    `offset` (optional) (integer) Return Point details starting at this offset</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;list(all_my_agents=</span><span class="si">%s</span><span class="s2">, limit=</span><span class="si">%s</span><span class="s2">, offset=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">all_my_agents</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">all_my_agents</span><span class="p">:</span>
        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_entity_list_all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_entity_list</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">evt</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;entities&#39;</span><span class="p">]</span>  <span class="c1"># pylint:disable=unsubscriptable-object</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.register_callback_created">
    <p>def <span class="ident">register_callback_created</span>(</p><p>self, func, serialised=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Register a callback for resource creation.  This will be called when any <em>new</em> resource
is created within your agent.  If <code>serialised</code> is not set, the callbacks might arrive
in a different order to they were requested.</p>
<p>The payload passed to your callback is an OrderedDict with the following keys</p>
<div class="codehilite"><pre><span></span><span class="n">r</span>         <span class="p">:</span> <span class="n">R_ENTITY</span><span class="p">,</span> <span class="n">R_FEED</span><span class="p">,</span> <span class="n">etc</span> <span class="c1"># the type of resource created</span>
<span class="n">lid</span>       <span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>                <span class="c1"># the local name of the resource</span>
<span class="nb">id</span>        <span class="p">:</span> <span class="o">&lt;</span><span class="n">GUID</span><span class="o">&gt;</span>                <span class="c1"># the global Id of the resource</span>
<span class="n">epId</span>      <span class="p">:</span> <span class="o">&lt;</span><span class="n">GUID</span><span class="o">&gt;</span>                <span class="c1"># the global Id of your agent</span>
</pre></div>


<p><code>Note</code> resource types are defined <a href="../Core/Const.m.html">here</a></p>
<p><code>Example</code></p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">created_callback</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">client</span><span class="o">.</span><span class="n">register_callback_created</span><span class="p">(</span><span class="n">created_callback</span><span class="p">)</span>
</pre></div>


<p>This would print out something like the following on creation of an R_ENTITY</p>
<div class="codehilite"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="sa">u</span><span class="s1">&#39;lid&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;new_thing1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
             <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;epId&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;ffd47b75ea786f55c76e337cdc47665a&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;3f11df0a09588a6a1a9732e3837765f8&#39;</span><span class="p">)]))</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.register_callback_created', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.register_callback_created" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">register_callback_created</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register a callback for resource creation.  This will be called when any *new* resource</span>
<span class="sd">    is created within your agent.  If `serialised` is not set, the callbacks might arrive</span>
<span class="sd">    in a different order to they were requested.</span>
<span class="sd">    The payload passed to your callback is an OrderedDict with the following keys</span>
<span class="sd">        #!python</span>
<span class="sd">        r         : R_ENTITY, R_FEED, etc # the type of resource created</span>
<span class="sd">        lid       : &lt;name&gt;                # the local name of the resource</span>
<span class="sd">        id        : &lt;GUID&gt;                # the global Id of the resource</span>
<span class="sd">        epId      : &lt;GUID&gt;                # the global Id of your agent</span>
<span class="sd">    `Note` resource types are defined [here](../Core/Const.m.html)</span>
<span class="sd">    `Example`</span>
<span class="sd">        #!python</span>
<span class="sd">        def created_callback(args):</span>
<span class="sd">            print(args)</span>
<span class="sd">        ...</span>
<span class="sd">        client.register_callback_created(created_callback)</span>
<span class="sd">    This would print out something like the following on creation of an R_ENTITY</span>
<span class="sd">        #!python</span>
<span class="sd">        OrderedDict([(u&#39;lid&#39;, u&#39;new_thing1&#39;), (u&#39;r&#39;, 1),</span>
<span class="sd">                     (u&#39;epId&#39;, u&#39;ffd47b75ea786f55c76e337cdc47665a&#39;),</span>
<span class="sd">                     (u&#39;id&#39;, u&#39;3f11df0a09588a6a1a9732e3837765f8&#39;)]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_created</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="o">=</span><span class="n">serialised</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.register_callback_deleted">
    <p>def <span class="ident">register_callback_deleted</span>(</p><p>self, func, serialised=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Register a callback for resource deletion.  This will be called when any resource
is deleted within your agent.
If <code>serialised</code> is not set, the callbacks might arrive in a different order to they were requested.</p>
<p>The payload passed to your callback is an OrderedDict with the following keys</p>
<div class="codehilite"><pre><span></span><span class="n">r</span>         <span class="p">:</span> <span class="n">R_ENTITY</span><span class="p">,</span> <span class="n">R_FEED</span><span class="p">,</span> <span class="n">etc</span> <span class="c1"># the type of resource deleted</span>
<span class="n">lid</span>       <span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>                <span class="c1"># the local name of the resource</span>
<span class="nb">id</span>        <span class="p">:</span> <span class="o">&lt;</span><span class="n">GUID</span><span class="o">&gt;</span>                <span class="c1"># the global Id of the resource</span>
</pre></div>


<p><code>Note</code> resource types are defined <a href="../Core/Const.m.html">here</a></p>
<p><code>Example</code></p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">deleted_callback</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">client</span><span class="o">.</span><span class="n">register_callback_deleted</span><span class="p">(</span><span class="n">deleted_callback</span><span class="p">)</span>
</pre></div>


<p>This would print out something like the following on deletion of an R_ENTITY</p>
<div class="codehilite"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="sa">u</span><span class="s1">&#39;lid&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;old_thing1&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
             <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;315637813d801ec6f057c67728bf00c2&#39;</span><span class="p">)])</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.register_callback_deleted', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.register_callback_deleted" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">register_callback_deleted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register a callback for resource deletion.  This will be called when any resource</span>
<span class="sd">    is deleted within your agent.</span>
<span class="sd">    If `serialised` is not set, the callbacks might arrive in a different order to they were requested.</span>
<span class="sd">    The payload passed to your callback is an OrderedDict with the following keys</span>
<span class="sd">        #!python</span>
<span class="sd">        r         : R_ENTITY, R_FEED, etc # the type of resource deleted</span>
<span class="sd">        lid       : &lt;name&gt;                # the local name of the resource</span>
<span class="sd">        id        : &lt;GUID&gt;                # the global Id of the resource</span>
<span class="sd">    `Note` resource types are defined [here](../Core/Const.m.html)</span>
<span class="sd">    `Example`</span>
<span class="sd">        #!python</span>
<span class="sd">        def deleted_callback(args):</span>
<span class="sd">            print(args)</span>
<span class="sd">        ...</span>
<span class="sd">        client.register_callback_deleted(deleted_callback)</span>
<span class="sd">    This would print out something like the following on deletion of an R_ENTITY</span>
<span class="sd">        #!python</span>
<span class="sd">        OrderedDict([(u&#39;lid&#39;, u&#39;old_thing1&#39;),</span>
<span class="sd">                     (u&#39;r&#39;, 1),</span>
<span class="sd">                     (u&#39;id&#39;, u&#39;315637813d801ec6f057c67728bf00c2&#39;)])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_deleted</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="o">=</span><span class="n">serialised</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.register_callback_duplicate">
    <p>def <span class="ident">register_callback_duplicate</span>(</p><p>self, func, serialised=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Register a callback for resource creation but where the resource already exists in Iotic Space.
In this case the existing reference is passed to you.
If <code>serialised</code> is not set, the callbacks might arrive in a different order to they were requested.</p>
<p>The payload passed to your callback is an OrderedDict with the following keys</p>
<div class="codehilite"><pre><span></span><span class="n">r</span>         <span class="p">:</span> <span class="n">R_ENTITY</span><span class="p">,</span> <span class="n">R_FEED</span><span class="p">,</span> <span class="n">etc</span> <span class="c1"># the type of existing resource</span>
<span class="n">lid</span>       <span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>                <span class="c1"># the local name of the</span>
                                  <span class="c1"># existing resource</span>
<span class="nb">id</span>        <span class="p">:</span> <span class="o">&lt;</span><span class="n">GUID</span><span class="o">&gt;</span>                <span class="c1"># the global Id of the</span>
                                  <span class="c1"># existing resource</span>
<span class="n">epId</span>      <span class="p">:</span> <span class="o">&lt;</span><span class="n">GUID</span><span class="o">&gt;</span>                <span class="c1"># the global Id of your agent</span>
</pre></div>


<p><code>Note</code> resource types are defined <a href="../Core/Const.m.html">here</a></p>
<p><code>Example</code></p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">duplicated_callback</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">client</span><span class="o">.</span><span class="n">register_callback_created</span><span class="p">(</span><span class="n">duplicated_callback</span><span class="p">)</span>
</pre></div>


<p>This would print out something like the following on re-creation of an R_ENTITY</p>
<div class="codehilite"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="sa">u</span><span class="s1">&#39;lid&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;new_thing1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
             <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;epId&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;ffd47b75ea786f55c76e337cdc47665a&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;3f11df0a09588a6a1a9732e3837765f8&#39;</span><span class="p">)]))</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.register_callback_duplicate', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.register_callback_duplicate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">register_callback_duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register a callback for resource creation but where the resource already exists in Iotic Space.</span>
<span class="sd">    In this case the existing reference is passed to you.</span>
<span class="sd">    If `serialised` is not set, the callbacks might arrive in a different order to they were requested.</span>
<span class="sd">    The payload passed to your callback is an OrderedDict with the following keys</span>
<span class="sd">        #!python</span>
<span class="sd">        r         : R_ENTITY, R_FEED, etc # the type of existing resource</span>
<span class="sd">        lid       : &lt;name&gt;                # the local name of the</span>
<span class="sd">                                          # existing resource</span>
<span class="sd">        id        : &lt;GUID&gt;                # the global Id of the</span>
<span class="sd">                                          # existing resource</span>
<span class="sd">        epId      : &lt;GUID&gt;                # the global Id of your agent</span>
<span class="sd">    `Note` resource types are defined [here](../Core/Const.m.html)</span>
<span class="sd">    `Example`</span>
<span class="sd">        #!python</span>
<span class="sd">        def duplicated_callback(args):</span>
<span class="sd">            print(args)</span>
<span class="sd">        ...</span>
<span class="sd">        client.register_callback_created(duplicated_callback)</span>
<span class="sd">    This would print out something like the following on re-creation of an R_ENTITY</span>
<span class="sd">        #!python</span>
<span class="sd">        OrderedDict([(u&#39;lid&#39;, u&#39;new_thing1&#39;), (u&#39;r&#39;, 1),</span>
<span class="sd">                     (u&#39;epId&#39;, u&#39;ffd47b75ea786f55c76e337cdc47665a&#39;),</span>
<span class="sd">                     (u&#39;id&#39;, u&#39;3f11df0a09588a6a1a9732e3837765f8&#39;)]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_duplicate</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="o">=</span><span class="n">serialised</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.register_callback_reassigned">
    <p>def <span class="ident">register_callback_reassigned</span>(</p><p>self, func, serialised=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Register a callback for resource reassignment.  This will be called when any resource
is reassigned to or from your agent.
If <code>serialised</code> is not set, the callbacks might arrive in a different order to they were requested.</p>
<p>The payload passed to your callback is an OrderedDict with the following keys</p>
<div class="codehilite"><pre><span></span><span class="n">r</span>         <span class="p">:</span> <span class="n">R_ENTITY</span><span class="p">,</span> <span class="n">R_FEED</span><span class="p">,</span> <span class="n">etc</span> <span class="c1"># the type of resource reassigned</span>
<span class="n">lid</span>       <span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>                <span class="c1"># the local name of the resource</span>
<span class="n">epId</span>      <span class="p">:</span> <span class="o">&lt;</span><span class="n">GUID</span><span class="o">&gt;</span>                <span class="c1"># the global Id of the agent the</span>
                                  <span class="c1"># resource has been reassigned *to*</span>
<span class="nb">id</span>        <span class="p">:</span> <span class="o">&lt;</span><span class="n">GUID</span><span class="o">&gt;</span>                <span class="c1"># the global Id of the resource</span>
</pre></div>


<p><code>Note</code> resource types are defined <a href="../Core/Const.m.html">here</a></p>
<p><code>Note</code> You can check whether this is an assign "in" or "out" by comparing the epId with your current
agent id, using the <code>IOT.Client.agent_id</code> property.  If it's the same it's a reassign to you.</p>
<p><code>Example</code></p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">reassigned_callback</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">client</span><span class="o">.</span><span class="n">register_callback_reassigned</span><span class="p">(</span><span class="n">reassigned_callback</span><span class="p">)</span>
</pre></div>


<p>This would print out something like the following on assignment of an R_ENTITY to</p>
<div class="codehilite"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="sa">u</span><span class="s1">&#39;lid&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;moved_thing&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
             <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;epId&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;5a8d603ee757133d66d99875d0584c72&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;4448993b44738411de5fe2a6cf32d957&#39;</span><span class="p">)])</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.register_callback_reassigned', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.register_callback_reassigned" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">register_callback_reassigned</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register a callback for resource reassignment.  This will be called when any resource</span>
<span class="sd">    is reassigned to or from your agent.</span>
<span class="sd">    If `serialised` is not set, the callbacks might arrive in a different order to they were requested.</span>
<span class="sd">    The payload passed to your callback is an OrderedDict with the following keys</span>
<span class="sd">        #!python</span>
<span class="sd">        r         : R_ENTITY, R_FEED, etc # the type of resource reassigned</span>
<span class="sd">        lid       : &lt;name&gt;                # the local name of the resource</span>
<span class="sd">        epId      : &lt;GUID&gt;                # the global Id of the agent the</span>
<span class="sd">                                          # resource has been reassigned *to*</span>
<span class="sd">        id        : &lt;GUID&gt;                # the global Id of the resource</span>
<span class="sd">    `Note` resource types are defined [here](../Core/Const.m.html)</span>
<span class="sd">    `Note` You can check whether this is an assign &quot;in&quot; or &quot;out&quot; by comparing the epId with your current</span>
<span class="sd">    agent id, using the `IOT.Client.agent_id` property.  If it&#39;s the same it&#39;s a reassign to you.</span>
<span class="sd">    `Example`</span>
<span class="sd">        #!python</span>
<span class="sd">        def reassigned_callback(args):</span>
<span class="sd">            print(args)</span>
<span class="sd">        ...</span>
<span class="sd">        client.register_callback_reassigned(reassigned_callback)</span>
<span class="sd">    This would print out something like the following on assignment of an R_ENTITY to</span>
<span class="sd">        #!python</span>
<span class="sd">        OrderedDict([(u&#39;lid&#39;, u&#39;moved_thing&#39;),</span>
<span class="sd">                     (u&#39;r&#39;, 1),</span>
<span class="sd">                     (u&#39;epId&#39;, u&#39;5a8d603ee757133d66d99875d0584c72&#39;),</span>
<span class="sd">                     (u&#39;id&#39;, u&#39;4448993b44738411de5fe2a6cf32d957&#39;)])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_reassigned</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.register_callback_renamed">
    <p>def <span class="ident">register_callback_renamed</span>(</p><p>self, func, serialised=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Register a callback for resource rename.  This will be called when any resource
is renamed within your agent.
If <code>serialised</code> is not set, the callbacks might arrive in a different order to they were requested.</p>
<p>The payload passed to your callback is an OrderedDict with the following keys</p>
<div class="codehilite"><pre><span></span><span class="n">r</span>         <span class="p">:</span> <span class="n">R_ENTITY</span><span class="p">,</span> <span class="n">R_FEED</span><span class="p">,</span> <span class="n">etc</span> <span class="c1"># the type of resource deleted</span>
<span class="n">lid</span>       <span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>                <span class="c1"># the new local name of the resource</span>
<span class="n">oldLid</span>    <span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>                <span class="c1"># the old local name of the resource</span>
<span class="nb">id</span>        <span class="p">:</span> <span class="o">&lt;</span><span class="n">GUID</span><span class="o">&gt;</span>                <span class="c1"># the global Id of the resource</span>
</pre></div>


<p><code>Note</code> resource types are defined <a href="../Core/Const.m.html">here</a></p>
<p><code>Example</code></p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">renamed_callback</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">client</span><span class="o">.</span><span class="n">register_callback_renamed</span><span class="p">(</span><span class="n">renamed_callback</span><span class="p">)</span>
</pre></div>


<p>This would print out something like the following on renaming of an R_ENTITY</p>
<div class="codehilite"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="sa">u</span><span class="s1">&#39;lid&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;new_name&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
             <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;oldLid&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;old_name&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="sa">u</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;4448993b44738411de5fe2a6cf32d957&#39;</span><span class="p">)])</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.register_callback_renamed', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.register_callback_renamed" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">register_callback_renamed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">serialised</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register a callback for resource rename.  This will be called when any resource</span>
<span class="sd">    is renamed within your agent.</span>
<span class="sd">    If `serialised` is not set, the callbacks might arrive in a different order to they were requested.</span>
<span class="sd">    The payload passed to your callback is an OrderedDict with the following keys</span>
<span class="sd">        #!python</span>
<span class="sd">        r         : R_ENTITY, R_FEED, etc # the type of resource deleted</span>
<span class="sd">        lid       : &lt;name&gt;                # the new local name of the resource</span>
<span class="sd">        oldLid    : &lt;name&gt;                # the old local name of the resource</span>
<span class="sd">        id        : &lt;GUID&gt;                # the global Id of the resource</span>
<span class="sd">    `Note` resource types are defined [here](../Core/Const.m.html)</span>
<span class="sd">    `Example`</span>
<span class="sd">        #!python</span>
<span class="sd">        def renamed_callback(args):</span>
<span class="sd">            print(args)</span>
<span class="sd">        ...</span>
<span class="sd">        client.register_callback_renamed(renamed_callback)</span>
<span class="sd">    This would print out something like the following on renaming of an R_ENTITY</span>
<span class="sd">        #!python</span>
<span class="sd">        OrderedDict([(u&#39;lid&#39;, u&#39;new_name&#39;),</span>
<span class="sd">                     (u&#39;r&#39;, 1),</span>
<span class="sd">                     (u&#39;oldLid&#39;, u&#39;old_name&#39;),</span>
<span class="sd">                     (u&#39;id&#39;, u&#39;4448993b44738411de5fe2a6cf32d957&#39;)])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_renamed</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_payload_only</span><span class="p">,</span> <span class="n">func</span><span class="p">),</span> <span class="n">serialised</span><span class="o">=</span><span class="n">serialised</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.register_callback_subscribed">
    <p>def <span class="ident">register_callback_subscribed</span>(</p><p>self, callback)</p>
    </div>
    

    
  
    <div class="desc"><p>Register a callback for new subscription. This gets called whenever one of <em>your</em> things subscribes to something
else.</p>
<p><code>Note</code> it is not called when whenever something else subscribes to your thing.</p>
<p>The payload passed to your callback is either a
<a href="RemotePoint.m.html#IoticAgent.IOT.RemotePoint.RemoteControl">RemoteControl</a> or
<a href="RemotePoint.m.html#IoticAgent.IOT.RemotePoint.RemoteFeed">RemoteFeed</a> instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.register_callback_subscribed', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.register_callback_subscribed" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">register_callback_subscribed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register a callback for new subscription. This gets called whenever one of *your* things subscribes to something</span>
<span class="sd">    else.</span>
<span class="sd">    `Note` it is not called when whenever something else subscribes to your thing.</span>
<span class="sd">    The payload passed to your callback is either a</span>
<span class="sd">    [RemoteControl](RemotePoint.m.html#IoticAgent.IOT.RemotePoint.RemoteControl) or</span>
<span class="sd">    [RemoteFeed](RemotePoint.m.html#IoticAgent.IOT.RemotePoint.RemoteFeed) instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_created</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback_subscribed_filter</span><span class="p">,</span> <span class="n">callback</span><span class="p">),</span>
                                                   <span class="n">serialised</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.register_callback_subscription">
    <p>def <span class="ident">register_callback_subscription</span>(</p><p>self, callback)</p>
    </div>
    

    
  
    <div class="desc"><p>Register a callback for subscription count change notification.  This gets called whenever something <em>else</em>
subscribes to your thing.</p>
<p><code>Note</code> it is not called when you subscribe to something else.</p>
<p>The payload passed to your callback is an OrderedDict with the following keys</p>
<div class="codehilite"><pre><span></span><span class="n">r</span>         <span class="p">:</span> <span class="n">R_FEED</span> <span class="ow">or</span> <span class="n">R_CONTROL</span> <span class="c1"># the type of the point</span>
<span class="n">lid</span>       <span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>              <span class="c1"># the local name of your *Point*</span>
<span class="n">entityLid</span> <span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>              <span class="c1"># the local name of your *Thing*</span>
<span class="n">subCount</span>  <span class="p">:</span> <span class="o">&lt;</span><span class="n">count</span><span class="o">&gt;</span>             <span class="c1"># the total number of remote Things</span>
                                <span class="c1"># that subscribe to your point</span>
</pre></div>


<p><code>Example</code></p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">subscription_callback</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">client</span><span class="o">.</span><span class="n">register_callback_subscription</span><span class="p">(</span><span class="n">subscription_callback</span><span class="p">)</span>
</pre></div>


<p>This would print out something like the following</p>
<div class="codehilite"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;lid&#39;</span><span class="p">,</span> <span class="s1">&#39;My_First_Point&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;entityLid&#39;</span><span class="p">,</span> <span class="s1">&#39;My_First_Thing&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;subCount&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">)])</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.register_callback_subscription', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.register_callback_subscription" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">register_callback_subscription</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register a callback for subscription count change notification.  This gets called whenever something *else*</span>
<span class="sd">    subscribes to your thing.</span>
<span class="sd">    `Note` it is not called when you subscribe to something else.</span>
<span class="sd">    The payload passed to your callback is an OrderedDict with the following keys</span>
<span class="sd">        #!python</span>
<span class="sd">        r         : R_FEED or R_CONTROL # the type of the point</span>
<span class="sd">        lid       : &lt;name&gt;              # the local name of your *Point*</span>
<span class="sd">        entityLid : &lt;name&gt;              # the local name of your *Thing*</span>
<span class="sd">        subCount  : &lt;count&gt;             # the total number of remote Things</span>
<span class="sd">                                        # that subscribe to your point</span>
<span class="sd">    `Example`</span>
<span class="sd">        #!python</span>
<span class="sd">        def subscription_callback(args):</span>
<span class="sd">            print(args)</span>
<span class="sd">        ...</span>
<span class="sd">        client.register_callback_subscription(subscription_callback)</span>
<span class="sd">    This would print out something like the following</span>
<span class="sd">        #!python</span>
<span class="sd">        OrderedDict([(&#39;r&#39;, 2), (&#39;lid&#39;, &#39;My_First_Point&#39;),</span>
<span class="sd">                     (&#39;entityLid&#39;, &#39;My_First_Thing&#39;), (&#39;subCount&#39;, 13)])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_subscription</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.register_catchall_controlreq">
    <p>def <span class="ident">register_catchall_controlreq</span>(</p><p>self, callback, callback_parsed=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Registers a callback that is called for all control requests received by your Thing</p>
<p><code>Example</code></p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">controlreq_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">client</span><span class="o">.</span><span class="n">register_catchall_controlreq</span><span class="p">(</span><span class="n">controlreq_callback</span><span class="p">)</span>
</pre></div>


<p><code>callback</code> (required) the function name that you want to be called on receipt of a new control request</p>
<p><code>callback_parsed</code> (optional) (function reference) callback function to invoke on receipt of a control ask/tell.
This is equivalent to <code>callback</code> except the dict includes the <code>parsed</code> key which holds the set of values in a
<a href="./Point.m.html#IoticAgent.IOT.Point.PointDataObject">PointDataObject</a> instance. If both <code>callback_parsed</code> and
<code>callback</code> have been specified, the former takes precedence and <code>callback</code> is only called if the point data
could not be parsed according to its current value description.</p>
<p>More details on the contents of the <code>data</code> dictionary for controls see:
<a href="./Thing.m.html#IoticAgent.IOT.Thing.Thing.create_control">create_control()</a></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.register_catchall_controlreq', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.register_catchall_controlreq" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">register_catchall_controlreq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Registers a callback that is called for all control requests received by your Thing</span>
<span class="sd">    `Example`</span>
<span class="sd">        #!python</span>
<span class="sd">        def controlreq_callback(data):</span>
<span class="sd">            print(data)</span>
<span class="sd">        ...</span>
<span class="sd">        client.register_catchall_controlreq(controlreq_callback)</span>
<span class="sd">    `callback` (required) the function name that you want to be called on receipt of a new control request</span>
<span class="sd">    `callback_parsed` (optional) (function reference) callback function to invoke on receipt of a control ask/tell.</span>
<span class="sd">    This is equivalent to `callback` except the dict includes the `parsed` key which holds the set of values in a</span>
<span class="sd">    [PointDataObject](./Point.m.html#IoticAgent.IOT.Point.PointDataObject) instance. If both `callback_parsed` and</span>
<span class="sd">    `callback` have been specified, the former takes precedence and `callback` is only called if the point data</span>
<span class="sd">    could not be parsed according to its current value description.</span>
<span class="sd">    More details on the contents of the `data` dictionary for controls see:</span>
<span class="sd">    [create_control()](./Thing.m.html#IoticAgent.IOT.Thing.Thing.create_control)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">callback_parsed</span><span class="p">:</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_parsed_control_callback</span><span class="p">(</span><span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_controlreq</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.register_catchall_feeddata">
    <p>def <span class="ident">register_catchall_feeddata</span>(</p><p>self, callback, callback_parsed=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Registers a callback that is called for all feeddata your Thing receives</p>
<p><code>Example</code></p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">feeddata_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">client</span><span class="o">.</span><span class="n">register_catchall_feeddata</span><span class="p">(</span><span class="n">feeddata_callback</span><span class="p">)</span>
</pre></div>


<p><code>callback</code> (required) the function name that you want to be called on receipt of new feed data</p>
<p><code>callback_parsed</code> (optional) (function reference) callback function to invoke on receipt of feed data. This is
equivalent to <code>callback</code> except the dict includes the <code>parsed</code> key which holds the set of values in a
<a href="./Point.m.html#IoticAgent.IOT.Point.PointDataObject">PointDataObject</a> instance. If both
<code>callback_parsed</code> and <code>callback</code> have been specified, the former takes precedence and <code>callback</code> is only called
if the point data could not be parsed according to its current value description.</p>
<p><code>NOTE</code>: <code>callback_parsed</code> can only be used if <code>auto_encode_decode</code> is enabled for the client instance.</p>
<p>More details on the contents of the <code>data</code> dictionary for feeds see:
<a href="./Thing.m.html#IoticAgent.IOT.Thing.Thing.follow">follow()</a></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.register_catchall_feeddata', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.register_catchall_feeddata" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">register_catchall_feeddata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">callback_parsed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Registers a callback that is called for all feeddata your Thing receives</span>
<span class="sd">    `Example`</span>
<span class="sd">        #!python</span>
<span class="sd">        def feeddata_callback(data):</span>
<span class="sd">            print(data)</span>
<span class="sd">        ...</span>
<span class="sd">        client.register_catchall_feeddata(feeddata_callback)</span>
<span class="sd">    `callback` (required) the function name that you want to be called on receipt of new feed data</span>
<span class="sd">    `callback_parsed` (optional) (function reference) callback function to invoke on receipt of feed data. This is</span>
<span class="sd">    equivalent to `callback` except the dict includes the `parsed` key which holds the set of values in a</span>
<span class="sd">    [PointDataObject](./Point.m.html#IoticAgent.IOT.Point.PointDataObject) instance. If both</span>
<span class="sd">    `callback_parsed` and `callback` have been specified, the former takes precedence and `callback` is only called</span>
<span class="sd">    if the point data could not be parsed according to its current value description.</span>
<span class="sd">    `NOTE`: `callback_parsed` can only be used if `auto_encode_decode` is enabled for the client instance.</span>
<span class="sd">    More details on the contents of the `data` dictionary for feeds see:</span>
<span class="sd">    [follow()](./Thing.m.html#IoticAgent.IOT.Thing.Thing.follow)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">callback_parsed</span><span class="p">:</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_parsed_feed_callback</span><span class="p">(</span><span class="n">callback_parsed</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">register_callback_feeddata</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.save_config">
    <p>def <span class="ident">save_config</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Save the config, update the seqnum &amp; default language</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.save_config', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.save_config" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save the config, update the seqnum &amp; default language</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;seqnum&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">get_seqnum</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">,</span> <span class="s1">&#39;lang&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">default_lang</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__config</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.search">
    <p>def <span class="ident">search</span>(</p><p>self, text=None, lang=None, location=None, unit=None, limit=50, offset=0, reduced=False, local=None, scope=&lt;SearchScope.PUBLIC: &#39;public&#39;&gt;)</p>
    </div>
    

    
  
    <div class="desc"><p>Search the Iotic Space for public Things with metadata matching the search parameters:
text, lang(uage), location, unit, limit, offset. Note that only things which have at least one point defined can
be found.</p>
<p>Returns dict of results as below (first with reduced=False, second with reduced=True)- OR -</p>
<div class="codehilite"><pre><span></span><span class="c1"># reduced=False returns dict similar to below</span>
<span class="p">{</span>
    <span class="s2">&quot;2b2d8b068e404861b19f9e060877e002&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.74803</span><span class="p">,</span>
        <span class="s2">&quot;matches&quot;</span><span class="p">:</span> <span class="mf">3.500</span><span class="p">,</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mf">52.4539</span><span class="p">,</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Weather Station #2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;3bbf307b43b1460289fe707619dece3d&quot;</span><span class="p">,</span>
        <span class="s2">&quot;points&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;a300cc90147f4e2990195639de0af201&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;matches&quot;</span><span class="p">:</span> <span class="mf">3.000</span><span class="p">,</span>
                <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Feed 201&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feed&quot;</span><span class="p">,</span>
                <span class="s2">&quot;storesRecent&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">},</span>
            <span class="s2">&quot;a300cc90147f4e2990195639de0af202&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;matches&quot;</span><span class="p">:</span> <span class="mf">1.500</span><span class="p">,</span>
                <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Feed 202&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feed&quot;</span><span class="p">,</span>
                <span class="s2">&quot;storesRecent&quot;</span><span class="p">:</span> <span class="n">false</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;76a3b24b02d34f20b675257624b0e001&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="mf">0.716356</span><span class="p">,</span>
        <span class="s2">&quot;matches&quot;</span><span class="p">:</span> <span class="mf">2.000</span><span class="p">,</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mf">52.244384</span><span class="p">,</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Weather Station #1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;3bbf307b43b1460289fe707619dece3d&quot;</span><span class="p">,</span>
        <span class="s2">&quot;points&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;fb1a4a4dbb2642ab9f836892da93f101&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;matches&quot;</span><span class="p">:</span> <span class="mf">1.000</span><span class="p">,</span>
                <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;My weather feed&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feed&quot;</span><span class="p">,</span>
                <span class="s2">&quot;storesRecent&quot;</span><span class="p">:</span> <span class="n">false</span>
            <span class="p">},</span>
            <span class="s2">&quot;fb1a4a4dbb2642ab9f836892da93c102&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;matches&quot;</span><span class="p">:</span> <span class="mf">1.000</span><span class="p">,</span>
                <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Control&quot;</span><span class="p">,</span>
                <span class="s2">&quot;storesRecent&quot;</span><span class="p">:</span> <span class="n">false</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># reduced=True returns dict similar to below</span>
<span class="p">{</span>
    <span class="s2">&quot;2b2d8b068e404861b19f9e060877e002&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;a300cc90147f4e2990195639de0af201&quot;</span><span class="p">:</span> <span class="s2">&quot;Feed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;a300cc90147f4e2990195639de0af202&quot;</span><span class="p">:</span> <span class="s2">&quot;Feed&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;76a3b24b02d34f20b675257624b0e001&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;fb1a4a4dbb2642ab9f836892da93f101&quot;</span><span class="p">:</span> <span class="s2">&quot;Feed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fb1a4a4dbb2642ab9f836892da93f102&quot;</span><span class="p">:</span> <span class="s2">&quot;Control&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Raises <a href="./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException">IOTException</a>
containing the error if the infrastructure detects a problem</p>
<p>Raises <a href="../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException">LinkException</a>
if there is a communications problem between you and the infrastructure</p>
<p><code>text</code> (optional) (string) The text to search for. Label and description will be searched
for both Thing and Point and each word will be used as a tag search too. Text search is case-insensitive. Tag
search is language neutral.</p>
<p><code>lang</code> (optional) (string) The two-character ISO 639-1 language code to search in, e.g. "en" "fr"
Language is used to limit search to only labels and descriptions in that language. You will only get labels <code>in
that language</code> back from search and then only if there are any in that language.</p>
<p><code>location</code> (optional) (dictionary) Latitude, longitude and radius to search within.
All values are float, Radius is in kilometers (km). E.g. <code>{"lat"=1.2345, "long"=54.321, "radius"=6.789}</code>. Note:
If <code>text</code> has not been specified, radius can at most be 25km.</p>
<p><code>unit</code> (optional) (string) Valid URL of a unit in an ontology.  Or use a constant from the
<a href="../Units.m.html#IoticAgent.Units">units</a> class - such as <a href="../Units.m.html#IoticAgent.Units.METRE">METRE</a>.</p>
<p><code>limit</code> (optional) (integer) Return this many search results.</p>
<p><code>offset</code> (optional) (integer) Return results starting at this offset - good for paging.</p>
<p><code>reduced</code> (optional) (boolean) If <code>true</code>, return the reduced results just containing points and
their type.</p>
<p><code>local</code> (optional) (boolean) <strong>Deprecated</strong>, use <code>scope</code> instead. If <code>true</code>, perform search at container level.
Check the local_meta flag to determine whether local metadata functionality is available. (Takes precedence over
<code>scope</code>.)</p>
<p><code>scope</code> (optional) (<a href="../Core/Const.m.html#IoticAgent.Core.Const.SearchScope">SearchScope</a>) Whether to perform
PUBLIC, LOCAL (container level) or LOCAL_OWN (container level restricted to own things) search. Check the
<a href="#IoticAgent.IOT.Client.Client.local_meta">local_meta</a> flag to determine whether local metadata functionality is
available. (Note that PUBLIC and LOCAL_OWN scopes are always available.)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.search', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.search" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">reduced</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
           <span class="n">scope</span><span class="o">=</span><span class="n">SearchScope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Search the Iotic Space for public Things with metadata matching the search parameters:</span>
<span class="sd">    text, lang(uage), location, unit, limit, offset. Note that only things which have at least one point defined can</span>
<span class="sd">    be found.</span>
<span class="sd">    Returns dict of results as below (first with reduced=False, second with reduced=True)- OR -</span>
<span class="sd">        #!python</span>
<span class="sd">        # reduced=False returns dict similar to below</span>
<span class="sd">        {</span>
<span class="sd">            &quot;2b2d8b068e404861b19f9e060877e002&quot;: {</span>
<span class="sd">                &quot;long&quot;: -1.74803,</span>
<span class="sd">                &quot;matches&quot;: 3.500,</span>
<span class="sd">                &quot;lat&quot;: 52.4539,</span>
<span class="sd">                &quot;label&quot;: &quot;Weather Station #2&quot;,</span>
<span class="sd">                &quot;owner&quot;: &quot;3bbf307b43b1460289fe707619dece3d&quot;,</span>
<span class="sd">                &quot;points&quot;: {</span>
<span class="sd">                    &quot;a300cc90147f4e2990195639de0af201&quot;: {</span>
<span class="sd">                        &quot;matches&quot;: 3.000,</span>
<span class="sd">                        &quot;label&quot;: &quot;Feed 201&quot;,</span>
<span class="sd">                        &quot;type&quot;: &quot;Feed&quot;,</span>
<span class="sd">                        &quot;storesRecent&quot;: true</span>
<span class="sd">                    },</span>
<span class="sd">                    &quot;a300cc90147f4e2990195639de0af202&quot;: {</span>
<span class="sd">                        &quot;matches&quot;: 1.500,</span>
<span class="sd">                        &quot;label&quot;: &quot;Feed 202&quot;,</span>
<span class="sd">                        &quot;type&quot;: &quot;Feed&quot;,</span>
<span class="sd">                        &quot;storesRecent&quot;: false</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            },</span>
<span class="sd">            &quot;76a3b24b02d34f20b675257624b0e001&quot;: {</span>
<span class="sd">                &quot;long&quot;: 0.716356,</span>
<span class="sd">                &quot;matches&quot;: 2.000,</span>
<span class="sd">                &quot;lat&quot;: 52.244384,</span>
<span class="sd">                &quot;label&quot;: &quot;Weather Station #1&quot;,</span>
<span class="sd">                &quot;owner&quot;: &quot;3bbf307b43b1460289fe707619dece3d&quot;,</span>
<span class="sd">                &quot;points&quot;: {</span>
<span class="sd">                    &quot;fb1a4a4dbb2642ab9f836892da93f101&quot;: {</span>
<span class="sd">                        &quot;matches&quot;: 1.000,</span>
<span class="sd">                        &quot;label&quot;: &quot;My weather feed&quot;,</span>
<span class="sd">                        &quot;type&quot;: &quot;Feed&quot;,</span>
<span class="sd">                        &quot;storesRecent&quot;: false</span>
<span class="sd">                    },</span>
<span class="sd">                    &quot;fb1a4a4dbb2642ab9f836892da93c102&quot;: {</span>
<span class="sd">                        &quot;matches&quot;: 1.000,</span>
<span class="sd">                        &quot;label&quot;: None,</span>
<span class="sd">                        &quot;type&quot;: &quot;Control&quot;,</span>
<span class="sd">                        &quot;storesRecent&quot;: false</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            }</span>
<span class="sd">        }</span>
<span class="sd">        # reduced=True returns dict similar to below</span>
<span class="sd">        {</span>
<span class="sd">            &quot;2b2d8b068e404861b19f9e060877e002&quot;: {</span>
<span class="sd">                &quot;a300cc90147f4e2990195639de0af201&quot;: &quot;Feed&quot;,</span>
<span class="sd">                &quot;a300cc90147f4e2990195639de0af202&quot;: &quot;Feed&quot;</span>
<span class="sd">            },</span>
<span class="sd">            &quot;76a3b24b02d34f20b675257624b0e001&quot;: {</span>
<span class="sd">                &quot;fb1a4a4dbb2642ab9f836892da93f101&quot;: &quot;Feed&quot;,</span>
<span class="sd">                &quot;fb1a4a4dbb2642ab9f836892da93f102&quot;: &quot;Control&quot;</span>
<span class="sd">            }</span>
<span class="sd">        }</span>
<span class="sd">    Raises [IOTException](./Exceptions.m.html#IoticAgent.IOT.Exceptions.IOTException)</span>
<span class="sd">    containing the error if the infrastructure detects a problem</span>
<span class="sd">    Raises [LinkException](../Core/AmqpLink.m.html#IoticAgent.Core.AmqpLink.LinkException)</span>
<span class="sd">    if there is a communications problem between you and the infrastructure</span>
<span class="sd">    `text` (optional) (string) The text to search for. Label and description will be searched</span>
<span class="sd">    for both Thing and Point and each word will be used as a tag search too. Text search is case-insensitive. Tag</span>
<span class="sd">    search is language neutral.</span>
<span class="sd">    `lang` (optional) (string) The two-character ISO 639-1 language code to search in, e.g. &quot;en&quot; &quot;fr&quot;</span>
<span class="sd">    Language is used to limit search to only labels and descriptions in that language. You will only get labels `in</span>
<span class="sd">    that language` back from search and then only if there are any in that language.</span>
<span class="sd">    `location` (optional) (dictionary) Latitude, longitude and radius to search within.</span>
<span class="sd">    All values are float, Radius is in kilometers (km). E.g. `{&quot;lat&quot;=1.2345, &quot;long&quot;=54.321, &quot;radius&quot;=6.789}`. Note:</span>
<span class="sd">    If `text` has not been specified, radius can at most be 25km.</span>
<span class="sd">    `unit` (optional) (string) Valid URL of a unit in an ontology.  Or use a constant from the</span>
<span class="sd">    [units](../Units.m.html#IoticAgent.Units) class - such as [METRE](../Units.m.html#IoticAgent.Units.METRE).</span>
<span class="sd">    `limit` (optional) (integer) Return this many search results.</span>
<span class="sd">    `offset` (optional) (integer) Return results starting at this offset - good for paging.</span>
<span class="sd">    `reduced` (optional) (boolean) If `true`, return the reduced results just containing points and</span>
<span class="sd">    their type.</span>
<span class="sd">    `local` (optional) (boolean) **Deprecated**, use `scope` instead. If `true`, perform search at container level.</span>
<span class="sd">    Check the local_meta flag to determine whether local metadata functionality is available. (Takes precedence over</span>
<span class="sd">    `scope`.)</span>
<span class="sd">    `scope` (optional) ([SearchScope](../Core/Const.m.html#IoticAgent.Core.Const.SearchScope)) Whether to perform</span>
<span class="sd">    PUBLIC, LOCAL (container level) or LOCAL_OWN (container level restricted to own things) search. Check the</span>
<span class="sd">    [local_meta](#IoticAgent.IOT.Client.Client.local_meta) flag to determine whether local metadata functionality is</span>
<span class="sd">    available. (Note that PUBLIC and LOCAL_OWN scopes are always available.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;search(text=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, lang=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, location=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, unit=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, limit=</span><span class="si">%s</span><span class="s2">, offset=</span><span class="si">%s</span><span class="s2">, reduced=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">reduced</span><span class="p">)</span>
    <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_search</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>
                               <span class="n">SearchType</span><span class="o">.</span><span class="n">REDUCED</span> <span class="k">if</span> <span class="n">reduced</span> <span class="k">else</span> <span class="n">SearchType</span><span class="o">.</span><span class="n">FULL</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">evt</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>  <span class="c1"># pylint: disable=unsubscriptable-object</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.search_located">
    <p>def <span class="ident">search_located</span>(</p><p>self, text=None, lang=None, location=None, unit=None, limit=100, offset=0, local=None, scope=&lt;SearchScope.PUBLIC: &#39;public&#39;&gt;)</p>
    </div>
    

    
  
    <div class="desc"><p>See <a href="#IoticAgent.IOT.Client.Client.search">search()</a> for general documentation. Provides a thing-only
result set comprised only of things which have a location set, e.g.:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="c1"># Keyed by thing id</span>
    <span class="s1">&#39;2b2d8b068e404861b19f9e060877e002&#39;</span><span class="p">:</span>
        <span class="c1"># location (g, lat &amp; long), label (l, optional)</span>
        <span class="p">{</span><span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">52.4539</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.74803</span><span class="p">),</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="s1">&#39;Weather Station #2&#39;</span><span class="p">},</span>
    <span class="s1">&#39;76a3b24b02d34f20b675257624b0e001&#39;</span><span class="p">:</span>
        <span class="p">{</span><span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">52.244384</span><span class="p">,</span> <span class="mf">0.716356</span><span class="p">),</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">},</span>
    <span class="s1">&#39;76a3b24b02d34f20b675257624b0e004&#39;</span><span class="p">:</span>
        <span class="p">{</span><span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">52.245384</span><span class="p">,</span> <span class="mf">0.717356</span><span class="p">),</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="s1">&#39;Gasometer&#39;</span><span class="p">},</span>
    <span class="s1">&#39;76a3b24b02d34f20b675257624b0e005&#39;</span><span class="p">:</span>
        <span class="p">{</span><span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">52.245384</span><span class="p">,</span> <span class="mf">0.717356</span><span class="p">),</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="s1">&#39;Zepellin&#39;</span><span class="p">}</span>
<span class="p">}</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.search_located', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.search_located" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">search_located</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">scope</span><span class="o">=</span><span class="n">SearchScope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;See [search()](#IoticAgent.IOT.Client.Client.search) for general documentation. Provides a thing-only</span>
<span class="sd">    result set comprised only of things which have a location set, e.g.:</span>
<span class="sd">        #!python</span>
<span class="sd">        {</span>
<span class="sd">            # Keyed by thing id</span>
<span class="sd">            &#39;2b2d8b068e404861b19f9e060877e002&#39;:</span>
<span class="sd">                # location (g, lat &amp; long), label (l, optional)</span>
<span class="sd">                {&#39;g&#39;: (52.4539, -1.74803), &#39;l&#39;: &#39;Weather Station #2&#39;},</span>
<span class="sd">            &#39;76a3b24b02d34f20b675257624b0e001&#39;:</span>
<span class="sd">                {&#39;g&#39;: (52.244384, 0.716356), &#39;l&#39;: None},</span>
<span class="sd">            &#39;76a3b24b02d34f20b675257624b0e004&#39;:</span>
<span class="sd">                {&#39;g&#39;: (52.245384, 0.717356), &#39;l&#39;: &#39;Gasometer&#39;},</span>
<span class="sd">            &#39;76a3b24b02d34f20b675257624b0e005&#39;:</span>
<span class="sd">                {&#39;g&#39;: (52.245384, 0.717356), &#39;l&#39;: &#39;Zepellin&#39;}</span>
<span class="sd">        }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;search_located(text=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, lang=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, location=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, unit=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, limit=</span><span class="si">%s</span><span class="s2">, offset=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
    <span class="n">evt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request_search</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">SearchType</span><span class="o">.</span><span class="n">LOCATED</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_wait_and_except_if_failed</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">evt</span><span class="o">.</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>  <span class="c1"># pylint: disable=unsubscriptable-object</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.search_reduced">
    <p>def <span class="ident">search_reduced</span>(</p><p>self, text=None, lang=None, location=None, unit=None, limit=100, offset=0, local=None, scope=&lt;SearchScope.PUBLIC: &#39;public&#39;&gt;)</p>
    </div>
    

    
  
    <div class="desc"><p>Shorthand for <a href="#IoticAgent.IOT.Client.Client.search">search()</a> with <code>reduced=True</code></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.search_reduced', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.search_reduced" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">search_reduced</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">scope</span><span class="o">=</span><span class="n">SearchScope</span><span class="o">.</span><span class="n">PUBLIC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Shorthand for [search()](#IoticAgent.IOT.Client.Client.search) with `reduced=True`&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">reduced</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">local</span><span class="o">=</span><span class="n">local</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="n">scope</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.simulate_feeddata">
    <p>def <span class="ident">simulate_feeddata</span>(</p><p>self, feedid, data, mime=None, time=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Simulate the last feeddata received for given feedid
Calls the registered callback for the feed with the last recieved feed data. Allows you to test your code
without having to wait for the remote thing to share again.</p>
<p><code>feedid</code> (required) (string) local id of your Feed</p>
<p><code>data</code> (optional) (as applicable) The data you want to use to simulate the arrival of remote feed data</p>
<p><code>mime</code> (optional) (string) The mime type of your data. See also:
<a href="./Point.m.html#IoticAgent.IOT.Point.Feed.share">share()</a></p>
<p><code>time</code> (optional) (datetime) UTC timestamp for share. See also:
<a href="./Point.m.html#IoticAgent.IOT.Point.Feed.share">share()</a></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.simulate_feeddata', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.simulate_feeddata" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">simulate_feeddata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feedid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simulate the last feeddata received for given feedid</span>
<span class="sd">    Calls the registered callback for the feed with the last recieved feed data. Allows you to test your code</span>
<span class="sd">    without having to wait for the remote thing to share again.</span>
<span class="sd">    `feedid` (required) (string) local id of your Feed</span>
<span class="sd">    `data` (optional) (as applicable) The data you want to use to simulate the arrival of remote feed data</span>
<span class="sd">    `mime` (optional) (string) The mime type of your data. See also:</span>
<span class="sd">    [share()](./Point.m.html#IoticAgent.IOT.Point.Feed.share)</span>
<span class="sd">    `time` (optional) (datetime) UTC timestamp for share. See also:</span>
<span class="sd">    [share()](./Point.m.html#IoticAgent.IOT.Point.Feed.share)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">simulate_feeddata</span><span class="p">(</span><span class="n">feedid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mime</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.start">
    <p>def <span class="ident">start</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Open a connection to Iotic Space.  <code>start()</code> is called by <code>__enter__</code> which allows the python
<code>with</code> syntax to be used.</p>
<p><code>Example 0</code> - Calling start() implicitly using with.  minimal example with no exception handling</p>
<div class="codehilite"><pre><span></span><span class="k">with</span> <span class="n">IOT</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s2">&quot;my_script.ini&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">create_thing</span><span class="p">(</span><span class="s2">&quot;my_thing&quot;</span><span class="p">)</span>
</pre></div>


<p><code>Example 1</code> - Calling start() implicitly using with.  This handles the finally for you. <code>Recommended</code></p>
<div class="codehilite"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">IOT</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s2">&quot;my_script.ini&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">client</span><span class="o">.</span><span class="n">create_thing</span><span class="p">(</span><span class="s2">&quot;my_thing&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">IOTException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="c1"># handle exception</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>  <span class="c1"># not possible to connect</span>
    <span class="k">print</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<p><code>Example 2</code> - Calling start() explicitly (no with)  Be careful, you have to put a finally in your try blocks
otherwise your client might remain connected.</p>
<div class="codehilite"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">IOT</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s2">&quot;my_script.ini&quot;</span><span class="p">)</span>
    <span class="c1"># wire up callbacks here</span>
    <span class="n">client</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">create_thing</span><span class="p">(</span><span class="s2">&quot;my_thing&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">IOTException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
    <span class="c1"># handle individual exception</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>


<p>Returns This Client instance</p>
<p>Raises Exception</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.start', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.start" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Open a connection to Iotic Space.  `start()` is called by `__enter__` which allows the python</span>
<span class="sd">    `with` syntax to be used.</span>
<span class="sd">    `Example 0` - Calling start() implicitly using with.  minimal example with no exception handling</span>
<span class="sd">        #!python</span>
<span class="sd">        with IOT.Client(config=&quot;my_script.ini&quot;) as client:</span>
<span class="sd">            client.create_thing(&quot;my_thing&quot;)</span>
<span class="sd">    `Example 1` - Calling start() implicitly using with.  This handles the finally for you. `Recommended`</span>
<span class="sd">        #!python</span>
<span class="sd">        try:</span>
<span class="sd">            with IOT.Client(config=&quot;my_script.ini&quot;) as client:</span>
<span class="sd">                try:</span>
<span class="sd">                    client.create_thing(&quot;my_thing&quot;)</span>
<span class="sd">                except IOTException as exc:</span>
<span class="sd">                    # handle exception</span>
<span class="sd">        except Exception as exc:  # not possible to connect</span>
<span class="sd">            print(exc)</span>
<span class="sd">            import sys</span>
<span class="sd">            sys.exit(1)</span>
<span class="sd">    `Example 2` - Calling start() explicitly (no with)  Be careful, you have to put a finally in your try blocks</span>
<span class="sd">    otherwise your client might remain connected.</span>
<span class="sd">        #!python</span>
<span class="sd">        try:</span>
<span class="sd">            client = IOT.Client(config=&quot;my_script.ini&quot;)</span>
<span class="sd">            # wire up callbacks here</span>
<span class="sd">            client.start()</span>
<span class="sd">        except Exception as exc:</span>
<span class="sd">            print(exc)</span>
<span class="sd">            import sys</span>
<span class="sd">            sys.exit(1)</span>
<span class="sd">        try:</span>
<span class="sd">            client.create_thing(&quot;my_thing&quot;)</span>
<span class="sd">        except IOTException as exc:</span>
<span class="sd">            # handle individual exception</span>
<span class="sd">        finally:</span>
<span class="sd">            client.stop()</span>
<span class="sd">    Returns This Client instance</span>
<span class="sd">    Raises Exception</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="IoticAgent.IOT.Client.Client.stop">
    <p>def <span class="ident">stop</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Close the connection to Iotic Space.  <code>stop()</code> is called by <code>__exit()__</code> allowing the python <code>with</code>
syntax to be used.  See <a href="#IoticAgent.IOT.Client.Client.start">start()</a></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-IoticAgent.IOT.Client.Client.stop', this);">Show source &equiv;</a></p>
  <div id="source-IoticAgent.IOT.Client.Client.stop" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Close the connection to Iotic Space.  `stop()` is called by `__exit()__` allowing the python `with`</span>
<span class="sd">    syntax to be used.  See [start()](#IoticAgent.IOT.Client.Client.start)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__client</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="IoticAgent.IOT.Client.Client.agent_id" class="name">var <span class="ident">agent_id</span></p>
            

            
  
    <div class="desc"><p>Agent id (aka epId) in use for this client instance</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="IoticAgent.IOT.Client.Client.default_lang" class="name">var <span class="ident">default_lang</span></p>
            

            
  
    <div class="desc"><p>Language in use when not explicitly specified (in meta related requests). Will be set to container default
if was not set in configuration. Before client has started this might be None.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="IoticAgent.IOT.Client.Client.local_meta" class="name">var <span class="ident">local_meta</span></p>
            

            
  
    <div class="desc"><p>Whether container-local metadata functionality (e.g. search) is available in this container. Before calling
start() this will always be False.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="IoticAgent.IOT.Client.Client.sync_timeout" class="name">var <span class="ident">sync_timeout</span></p>
            

            
  
    <div class="desc"><p>Value of iot.sync_request_timeout configuration option. Used by all synchronous requests to limit total
request wait time.</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
